<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Examples | rxode2 user manual</title>
  <meta name="description" content="This book is the user manual for rxode2" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Examples | rxode2 user manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is the user manual for rxode2" />
  <meta name="github-repo" content="nlmixr2/rxode2-manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Examples | rxode2 user manual" />
  
  <meta name="twitter:description" content="This book is the user manual for rxode2" />
  

<meta name="author" content="Matthew Fidler, Melissa Hallow, Wenping Wang" />


<meta name="date" content="2022-09-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation.html"/>
<link rel="next" href="advanced-miscellaneous-topics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.24/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i><b>2</b> Authors and Acknowledgments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="author.html"><a href="author.html#authors"><i class="fa fa-check"></i><b>2.1</b> Authors</a></li>
<li class="chapter" data-level="2.2" data-path="author.html"><a href="author.html#contributors"><i class="fa fa-check"></i><b>2.2</b> Contributors</a></li>
<li class="chapter" data-level="2.3" data-path="author.html"><a href="author.html#rxode-acknowledgments"><i class="fa fa-check"></i><b>2.3</b> RxODE acknowledgments:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="related.html"><a href="related.html"><i class="fa fa-check"></i><b>3</b> Related R packages</a>
<ul>
<li class="chapter" data-level="3.1" data-path="related.html"><a href="related.html#ode-solving"><i class="fa fa-check"></i><b>3.1</b> ODE solving</a></li>
<li class="chapter" data-level="3.2" data-path="related.html"><a href="related.html#pk-solved-systems"><i class="fa fa-check"></i><b>3.2</b> PK Solved systems</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="related.html"><a href="related.html#the-following-packages-for-solved-pk-systems-are-on-cran"><i class="fa fa-check"></i><b>3.2.1</b> The following packages for solved PK systems are on CRAN</a></li>
<li class="chapter" data-level="3.2.2" data-path="related.html"><a href="related.html#non-cran-libraries"><i class="fa fa-check"></i><b>3.2.2</b> Non-CRAN libraries:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>4</b> Installation</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="install.html"><a href="install.html#windows"><i class="fa fa-check"></i><b>4.0.1</b> Windows</a></li>
<li class="chapter" data-level="4.0.2" data-path="install.html"><a href="install.html#mac-osx"><i class="fa fa-check"></i><b>4.0.2</b> Mac OSX</a></li>
<li class="chapter" data-level="4.0.3" data-path="install.html"><a href="install.html#linux"><i class="fa fa-check"></i><b>4.0.3</b> Linux</a></li>
<li class="chapter" data-level="4.1" data-path="install.html"><a href="install.html#development-version"><i class="fa fa-check"></i><b>4.1</b> Development Version</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gettingStarted.html"><a href="gettingStarted.html"><i class="fa fa-check"></i><b>5</b> Getting Started</a>
<ul>
<li class="chapter" data-level="5.1" data-path="gettingStarted.html"><a href="gettingStarted.html#specify-ode-parameters-and-initial-conditions"><i class="fa fa-check"></i><b>5.1</b> Specify ODE parameters and initial conditions</a></li>
<li class="chapter" data-level="5.2" data-path="gettingStarted.html"><a href="gettingStarted.html#specify-dosing-and-sampling-in-rxode2"><i class="fa fa-check"></i><b>5.2</b> Specify Dosing and sampling in rxode2</a></li>
<li class="chapter" data-level="5.3" data-path="gettingStarted.html"><a href="gettingStarted.html#solving-odes"><i class="fa fa-check"></i><b>5.3</b> Solving ODEs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="syntax.html"><a href="syntax.html"><i class="fa fa-check"></i><b>6</b> rxode2 syntax</a>
<ul>
<li class="chapter" data-level="6.1" data-path="syntax.html"><a href="syntax.html#example"><i class="fa fa-check"></i><b>6.1</b> Example</a></li>
<li class="chapter" data-level="6.2" data-path="syntax.html"><a href="syntax.html#syntax-1"><i class="fa fa-check"></i><b>6.2</b> Syntax</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="syntax.html"><a href="syntax.html#identifiers"><i class="fa fa-check"></i><b>6.2.1</b> Identifiers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="syntax.html"><a href="syntax.html#logical-operators"><i class="fa fa-check"></i><b>6.3</b> Logical Operators</a></li>
<li class="chapter" data-level="6.4" data-path="syntax.html"><a href="syntax.html#cmt-changing-compartment-numbers-for-states"><i class="fa fa-check"></i><b>6.4</b> cmt() changing compartment numbers for states</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="syntax.html"><a href="syntax.html#how-rxode2-numbers-compartments"><i class="fa fa-check"></i><b>6.4.1</b> How rxode2 numbers compartments</a></li>
<li class="chapter" data-level="6.4.2" data-path="syntax.html"><a href="syntax.html#changing-compartments-by-pre-declaring-with-cmt"><i class="fa fa-check"></i><b>6.4.2</b> Changing compartments by pre-declaring with <code>cmt()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="syntax.html"><a href="syntax.html#appending-compartments-to-the-model-with-cmt"><i class="fa fa-check"></i><b>6.4.3</b> Appending compartments to the model with <code>cmt()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="events.html"><a href="events.html"><i class="fa fa-check"></i><b>7</b> rxode2 events</a>
<ul>
<li class="chapter" data-level="7.1" data-path="events.html"><a href="events.html#rxode2-event-tables"><i class="fa fa-check"></i><b>7.1</b> rxode2 event tables</a></li>
<li class="chapter" data-level="7.2" data-path="events.html"><a href="events.html#bolusadditive-doses"><i class="fa fa-check"></i><b>7.2</b> Bolus/Additive Doses</a></li>
<li class="chapter" data-level="7.3" data-path="events.html"><a href="events.html#infusion-doses"><i class="fa fa-check"></i><b>7.3</b> Infusion Doses</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="events.html"><a href="events.html#constant-infusion-in-terms-of-duration-and-rate"><i class="fa fa-check"></i><b>7.3.1</b> Constant Infusion (in terms of duration and rate)</a></li>
<li class="chapter" data-level="7.3.2" data-path="events.html"><a href="events.html#modeled-rate-and-duration-of-infusion"><i class="fa fa-check"></i><b>7.3.2</b> Modeled Rate and Duration of Infusion</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="events.html"><a href="events.html#steady-state"><i class="fa fa-check"></i><b>7.4</b> Steady State</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="events.html"><a href="events.html#steady-state-for-complex-dosing"><i class="fa fa-check"></i><b>7.4.1</b> Steady state for complex dosing</a></li>
<li class="chapter" data-level="7.4.2" data-path="events.html"><a href="events.html#steady-state-for-constant-infusion-or-zero-order-processes"><i class="fa fa-check"></i><b>7.4.2</b> Steady state for constant infusion or zero order processes</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="events.html"><a href="events.html#reset-events"><i class="fa fa-check"></i><b>7.5</b> Reset Events</a></li>
<li class="chapter" data-level="7.6" data-path="events.html"><a href="events.html#turning-off-compartments"><i class="fa fa-check"></i><b>7.6</b> Turning off compartments</a></li>
<li class="chapter" data-level="7.7" data-path="events.html"><a href="events.html#classic-et"><i class="fa fa-check"></i><b>7.7</b> Classic rxode2 events</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="events.html"><a href="events.html#bolus-dose-examples"><i class="fa fa-check"></i><b>7.7.1</b> Bolus Dose Examples</a></li>
<li class="chapter" data-level="7.7.2" data-path="events.html"><a href="events.html#infusion-event-examples"><i class="fa fa-check"></i><b>7.7.2</b> Infusion Event Examples</a></li>
<li class="chapter" data-level="7.7.3" data-path="events.html"><a href="events.html#steady-state-for-classic-rxode-evid-example"><i class="fa fa-check"></i><b>7.7.3</b> Steady State for classic RxODE EVID example</a></li>
<li class="chapter" data-level="7.7.4" data-path="events.html"><a href="events.html#turning-off-a-compartment-with-classic-rxode-evid"><i class="fa fa-check"></i><b>7.7.4</b> Turning off a compartment with classic RxODE EVID</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="events.html"><a href="events.html#datasets-for-rxode2-nlmixr"><i class="fa fa-check"></i><b>7.8</b> Datasets for rxode2 &amp; nlmixr</a></li>
<li class="chapter" data-level="7.9" data-path="events.html"><a href="events.html#columns-described-by-type-of-use"><i class="fa fa-check"></i><b>7.9</b> Columns Described by Type of Use</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="events.html"><a href="events.html#subject-identification-columns"><i class="fa fa-check"></i><b>7.9.1</b> Subject Identification Columns</a></li>
<li class="chapter" data-level="7.9.2" data-path="events.html"><a href="events.html#observation-columns"><i class="fa fa-check"></i><b>7.9.2</b> Observation Columns</a></li>
<li class="chapter" data-level="7.9.3" data-path="events.html"><a href="events.html#dosing-columns"><i class="fa fa-check"></i><b>7.9.3</b> Dosing Columns</a></li>
<li class="chapter" data-level="7.9.4" data-path="events.html"><a href="events.html#covariate-columns"><i class="fa fa-check"></i><b>7.9.4</b> Covariate Columns</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="events.html"><a href="events.html#details-for-specific-dataset-columns"><i class="fa fa-check"></i><b>7.10</b> Details for Specific Dataset Columns</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="events.html"><a href="events.html#amt-column"><i class="fa fa-check"></i><b>7.10.1</b> <code>AMT</code> Column</a></li>
<li class="chapter" data-level="7.10.2" data-path="events.html"><a href="events.html#censlimit-columns"><i class="fa fa-check"></i><b>7.10.2</b> <code>CENS</code>/<code>LIMIT</code> Columns</a></li>
<li class="chapter" data-level="7.10.3" data-path="events.html"><a href="events.html#cmt-column"><i class="fa fa-check"></i><b>7.10.3</b> <code>CMT</code> Column</a></li>
<li class="chapter" data-level="7.10.4" data-path="events.html"><a href="events.html#dur-column"><i class="fa fa-check"></i><b>7.10.4</b> <code>DUR</code> Column</a></li>
<li class="chapter" data-level="7.10.5" data-path="events.html"><a href="events.html#dv-column"><i class="fa fa-check"></i><b>7.10.5</b> <code>DV</code> Column</a></li>
<li class="chapter" data-level="7.10.6" data-path="events.html"><a href="events.html#dvid-column"><i class="fa fa-check"></i><b>7.10.6</b> <code>DVID</code> Column</a></li>
<li class="chapter" data-level="7.10.7" data-path="events.html"><a href="events.html#evid-column"><i class="fa fa-check"></i><b>7.10.7</b> <code>EVID</code> Column</a></li>
<li class="chapter" data-level="7.10.8" data-path="events.html"><a href="events.html#id-column"><i class="fa fa-check"></i><b>7.10.8</b> <code>ID</code> Column</a></li>
<li class="chapter" data-level="7.10.9" data-path="events.html"><a href="events.html#rate-column"><i class="fa fa-check"></i><b>7.10.9</b> <code>RATE</code> Column</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="et.html"><a href="et.html"><i class="fa fa-check"></i><b>8</b> Easily creating rxode2 events</a>
<ul>
<li class="chapter" data-level="8.1" data-path="et.html"><a href="et.html#adding-doses-to-the-event-table"><i class="fa fa-check"></i><b>8.1</b> Adding doses to the event table</a></li>
<li class="chapter" data-level="8.2" data-path="et.html"><a href="et.html#adding-sampling-to-an-event-table"><i class="fa fa-check"></i><b>8.2</b> Adding sampling to an event table</a></li>
<li class="chapter" data-level="8.3" data-path="et.html"><a href="et.html#expand-the-event-table-to-a-multi-subject-event-table."><i class="fa fa-check"></i><b>8.3</b> Expand the event table to a multi-subject event table.</a></li>
<li class="chapter" data-level="8.4" data-path="et.html"><a href="et.html#add-doses-and-samples-within-a-sampling-window"><i class="fa fa-check"></i><b>8.4</b> Add doses and samples within a sampling window</a></li>
<li class="chapter" data-level="8.5" data-path="et.html"><a href="et.html#combining-event-tables"><i class="fa fa-check"></i><b>8.5</b> Combining event tables</a></li>
<li class="chapter" data-level="8.6" data-path="et.html"><a href="et.html#sequencing-event-tables"><i class="fa fa-check"></i><b>8.6</b> Sequencing event tables</a></li>
<li class="chapter" data-level="8.7" data-path="et.html"><a href="et.html#repeating-event-tables"><i class="fa fa-check"></i><b>8.7</b> Repeating event tables</a></li>
<li class="chapter" data-level="8.8" data-path="et.html"><a href="et.html#combining-event-tables-with-rbind"><i class="fa fa-check"></i><b>8.8</b> Combining event tables with rbind</a></li>
<li class="chapter" data-level="8.9" data-path="et.html"><a href="et.html#expanding-events"><i class="fa fa-check"></i><b>8.9</b> Expanding events</a></li>
<li class="chapter" data-level="8.10" data-path="et.html"><a href="et.html#event-tables-in-rstudio-notebooks"><i class="fa fa-check"></i><b>8.10</b> Event tables in Rstudio Notebooks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="solve.html"><a href="solve.html"><i class="fa fa-check"></i><b>9</b> Solving and solving options</a>
<ul>
<li class="chapter" data-level="9.1" data-path="solve.html"><a href="solve.html#general-solving-options"><i class="fa fa-check"></i><b>9.1</b> General Solving Options</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="solve.html"><a href="solve.html#rxcontrol"><i class="fa fa-check"></i><b>9.1.1</b> rxControl</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>10</b> rxode2 output</a>
<ul>
<li class="chapter" data-level="10.1" data-path="output.html"><a href="output.html#using-rxode2-data-frames"><i class="fa fa-check"></i><b>10.1</b> Using rxode2 data frames</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="output.html"><a href="output.html#creating-an-interactive-data-frame"><i class="fa fa-check"></i><b>10.1.1</b> Creating an interactive data frame</a></li>
<li class="chapter" data-level="10.1.2" data-path="output.html"><a href="output.html#rxode2-solved-object-properties"><i class="fa fa-check"></i><b>10.1.2</b> rxode2 solved object properties</a></li>
<li class="chapter" data-level="10.1.3" data-path="output.html"><a href="output.html#using-the-solved-object-as-a-simple-data-frame"><i class="fa fa-check"></i><b>10.1.3</b> Using the solved object as a simple data frame</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="output.html"><a href="output.html#updating-the-data-set-interactively"><i class="fa fa-check"></i><b>10.2</b> Updating the data-set interactively</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="output.html"><a href="output.html#modifying-initial-conditions"><i class="fa fa-check"></i><b>10.2.1</b> Modifying initial conditions</a></li>
<li class="chapter" data-level="10.2.2" data-path="output.html"><a href="output.html#modifying-observation-times-for-rxode2"><i class="fa fa-check"></i><b>10.2.2</b> Modifying observation times for rxode2</a></li>
<li class="chapter" data-level="10.2.3" data-path="output.html"><a href="output.html#modifying-simulation-parameters"><i class="fa fa-check"></i><b>10.2.3</b> Modifying simulation parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>11</b> Simulation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="simulation.html"><a href="simulation.html#single-subject-solving"><i class="fa fa-check"></i><b>11.1</b> Single Subject solving</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="simulation.html"><a href="simulation.html#summary-of-single-solve-vs-multiple-subject-solving"><i class="fa fa-check"></i><b>11.1.1</b> Summary of Single solve vs Multiple subject solving</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="simulation.html"><a href="simulation.html#population-simulations-with-rxode2"><i class="fa fa-check"></i><b>11.2</b> Population Simulations with rxode2</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="simulation.html"><a href="simulation.html#simulation-of-variability-with-rxode2"><i class="fa fa-check"></i><b>11.2.1</b> Simulation of Variability with rxode2</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="simulation.html"><a href="simulation.html#simulation-of-clinical-trials"><i class="fa fa-check"></i><b>11.3</b> Simulation of Clinical Trials</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="simulation.html"><a href="simulation.html#simulation-from-inverse-wishart-correlations"><i class="fa fa-check"></i><b>11.3.1</b> Simulation from inverse Wishart correlations</a></li>
<li class="chapter" data-level="11.3.2" data-path="simulation.html"><a href="simulation.html#simulate-using-variancestandard-deviation-standard-errors"><i class="fa fa-check"></i><b>11.3.2</b> Simulate using variance/standard deviation standard errors</a></li>
<li class="chapter" data-level="11.3.3" data-path="simulation.html"><a href="simulation.html#simulate-without-uncertainty-in-omega-or-sigma-parameters"><i class="fa fa-check"></i><b>11.3.3</b> Simulate without uncertainty in <code>omega</code> or <code>sigma</code> parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="simulation.html"><a href="simulation.html#using-prior-data-for-solving"><i class="fa fa-check"></i><b>11.4</b> Using prior data for solving</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>12</b> Examples</a>
<ul>
<li class="chapter" data-level="12.1" data-path="examples.html"><a href="examples.html#prediction-only-models"><i class="fa fa-check"></i><b>12.1</b> Prediction only models</a></li>
<li class="chapter" data-level="12.2" data-path="examples.html"><a href="examples.html#solved-compartment-models"><i class="fa fa-check"></i><b>12.2</b> Solved compartment models</a></li>
<li class="chapter" data-level="12.3" data-path="examples.html"><a href="examples.html#mixing-solved-systems-and-odes"><i class="fa fa-check"></i><b>12.3</b> Mixing Solved Systems and ODEs</a></li>
<li class="chapter" data-level="12.4" data-path="examples.html"><a href="examples.html#weight-based-dosing"><i class="fa fa-check"></i><b>12.4</b> Weight based dosing</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="examples.html"><a href="examples.html#creating-a-2-compartment-model-in-rxode2"><i class="fa fa-check"></i><b>12.4.1</b> Creating a 2-compartment model in rxode2</a></li>
<li class="chapter" data-level="12.4.2" data-path="examples.html"><a href="examples.html#simulating-covariates"><i class="fa fa-check"></i><b>12.4.2</b> Simulating Covariates</a></li>
<li class="chapter" data-level="12.4.3" data-path="examples.html"><a href="examples.html#creating-weight-based-event-table"><i class="fa fa-check"></i><b>12.4.3</b> Creating weight based event table</a></li>
<li class="chapter" data-level="12.4.4" data-path="examples.html"><a href="examples.html#solving-daptomycin-simulation"><i class="fa fa-check"></i><b>12.4.4</b> Solving Daptomycin simulation</a></li>
<li class="chapter" data-level="12.4.5" data-path="examples.html"><a href="examples.html#daptomycin-reference"><i class="fa fa-check"></i><b>12.4.5</b> Daptomycin Reference</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="examples.html"><a href="examples.html#inter-occasion-and-other-nesting-examples"><i class="fa fa-check"></i><b>12.5</b> Inter-occasion and other nesting examples</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="examples.html"><a href="examples.html#event-table"><i class="fa fa-check"></i><b>12.5.1</b> Event table</a></li>
<li class="chapter" data-level="12.5.2" data-path="examples.html"><a href="examples.html#rxode2-model"><i class="fa fa-check"></i><b>12.5.2</b> rxode2 model</a></li>
<li class="chapter" data-level="12.5.3" data-path="examples.html"><a href="examples.html#uncertainty-in-model-parameters"><i class="fa fa-check"></i><b>12.5.3</b> Uncertainty in Model parameters</a></li>
<li class="chapter" data-level="12.5.4" data-path="examples.html"><a href="examples.html#nesting-variability"><i class="fa fa-check"></i><b>12.5.4</b> Nesting Variability</a></li>
<li class="chapter" data-level="12.5.5" data-path="examples.html"><a href="examples.html#unexplained-variability"><i class="fa fa-check"></i><b>12.5.5</b> Unexplained variability</a></li>
<li class="chapter" data-level="12.5.6" data-path="examples.html"><a href="examples.html#solving-the-problem"><i class="fa fa-check"></i><b>12.5.6</b> Solving the problem</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="examples.html"><a href="examples.html#transit-compartment-models"><i class="fa fa-check"></i><b>12.6</b> Transit compartment models</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html"><i class="fa fa-check"></i><b>13</b> Advanced &amp; Miscellaneous Topics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#covariates-in-rxode2"><i class="fa fa-check"></i><b>13.1</b> Covariates in rxode2</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#individual-covariates"><i class="fa fa-check"></i><b>13.1.1</b> Individual Covariates</a></li>
<li class="chapter" data-level="13.1.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#time-varying-covariates"><i class="fa fa-check"></i><b>13.1.2</b> Time Varying Covariates</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#shiny-and-rxode2"><i class="fa fa-check"></i><b>13.2</b> Shiny and rxode2</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#facilities-for-generating-r-shiny-applications"><i class="fa fa-check"></i><b>13.2.1</b> Facilities for generating R shiny applications</a></li>
<li class="chapter" data-level="13.2.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#exploring-parameter-fits-graphically-using-shiny"><i class="fa fa-check"></i><b>13.2.2</b> Exploring parameter fits graphically using shiny</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#using-rxode2-with-a-pipeline"><i class="fa fa-check"></i><b>13.3</b> Using rxode2 with a pipeline</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#setting-up-the-rxode2-model-for-the-pipeline"><i class="fa fa-check"></i><b>13.3.1</b> Setting up the rxode2 model for the pipeline</a></li>
<li class="chapter" data-level="13.3.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#simulating-one-event-table"><i class="fa fa-check"></i><b>13.3.2</b> Simulating one event table</a></li>
<li class="chapter" data-level="13.3.3" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#simulating-multiple-subjects-from-a-single-event-table"><i class="fa fa-check"></i><b>13.3.3</b> Simulating multiple subjects from a single event table</a></li>
<li class="chapter" data-level="13.3.4" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#summarizing-the-simulation-output"><i class="fa fa-check"></i><b>13.3.4</b> Summarizing the simulation output</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#speeding-up-rxode2"><i class="fa fa-check"></i><b>13.4</b> Speeding up rxode2</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#increasing-rxode2-speed-by-multi-subject-parallel-solving"><i class="fa fa-check"></i><b>13.4.1</b> Increasing rxode2 speed by multi-subject parallel solving</a></li>
<li class="chapter" data-level="13.4.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#a-real-life-example"><i class="fa fa-check"></i><b>13.4.2</b> A real life example</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#integrating-rxode2-models-in-your-package"><i class="fa fa-check"></i><b>13.5</b> Integrating rxode2 models in your package</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#using-pre-compiled-models-in-your-packages"><i class="fa fa-check"></i><b>13.5.1</b> Using Pre-compiled models in your packages</a></li>
<li class="chapter" data-level="13.5.2" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#using-models-in-a-already-present-package"><i class="fa fa-check"></i><b>13.5.2</b> Using Models in a already present package</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="advanced-miscellaneous-topics.html"><a href="advanced-miscellaneous-topics.html#stiff-odes-with-jacobian-specification"><i class="fa fa-check"></i><b>13.6</b> Stiff ODEs with Jacobian Specification</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">rxode2 user manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Examples<a href="examples.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is for example models to get you started in common
simulation scenarios.</p>
<div id="prediction-only-models" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Prediction only models<a href="examples.html#prediction-only-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Prediction only models are simple to create. You use the rxode2 syntax
without any ODE systems in them. A very simple example is a one-compartment model.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="examples.html#cb209-1" aria-hidden="true"></a><span class="kw">library</span>(rxode2)</span>
<span id="cb209-2"><a href="examples.html#cb209-2" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb209-3"><a href="examples.html#cb209-3" aria-hidden="true"></a>    ipre &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>ke <span class="op">*</span><span class="st"> </span>t);</span>
<span id="cb209-4"><a href="examples.html#cb209-4" aria-hidden="true"></a>})</span>
<span id="cb209-5"><a href="examples.html#cb209-5" aria-hidden="true"></a>mod</span></code></pre></div>
<pre><code>#&gt; rxode2 2.0.8 model named rx_21d6b058b7fd3920488bed6007f0474a model (✔ ready). 
#&gt; x$params: ke
#&gt; x$lhs: ipre</code></pre>
<p>Solving the rxode2 models are the same as saving the simple ODE system, but faster of course.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="examples.html#cb211-1" aria-hidden="true"></a>et  &lt;-<span class="st"> </span><span class="kw">et</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dt">length.out=</span><span class="dv">50</span>))</span>
<span id="cb211-2"><a href="examples.html#cb211-2" aria-hidden="true"></a>cmt1 &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(mod,et,<span class="dt">params=</span><span class="kw">c</span>(<span class="dt">ke=</span><span class="fl">0.5</span>))</span>
<span id="cb211-3"><a href="examples.html#cb211-3" aria-hidden="true"></a>cmt1</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters (x$params): ──
#&gt;  ke 
#&gt; 0.5 
#&gt; ── Initial Conditions (x$inits): ──
#&gt; named numeric(0)
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 50 × 2
#&gt;    time  ipre
#&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 0     10   
#&gt; 2 0.490  7.83
#&gt; 3 0.980  6.13
#&gt; 4 1.47   4.80
#&gt; 5 1.96   3.75
#&gt; 6 2.45   2.94
#&gt; # … with 44 more rows</code></pre>
</div>
<div id="solved-compartment-models" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Solved compartment models<a href="examples.html#solved-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Solved models are also simple to create. You simply place the
<code>linCmt()</code> psuedo-function into your code. The <code>linCmt()</code> function
figures out the type of model to use based on the parameter names
specified.</p>
<p>Most often, pharmacometric models are parameterized in terms of volume
and clearances. Clearances are specified by NONMEM-style names of
<code>CL</code>, <code>Q</code>, <code>Q1</code>, <code>Q2</code>, etc. or distributional clearances <code>CLD</code>,
<code>CLD2</code>. Volumes are specified by Central (<code>VC</code> or <code>V</code>),
Peripheral/Tissue (<code>VP</code>, <code>VT</code>). While more translations are
available, some example translations are below:</p>
<div id="htmlwidget-2c4e771b5897d6b171b8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2c4e771b5897d6b171b8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl","ka","cl"],["cl","q","cl","q","cl","q1","cl","q1","cl","q2","cl","q2","cl","cld","cl","cld","cl","cld2","cl","cld2","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","q","cl","q","cl","q","cl","q1","cl","q1","cl","q1","cl","q2","cl","q2","cl","q2","cl","cld","cl","cld","cl","cld","cl","cld2","cl","cld2","cl","cld2","cl","q","cl","q1","cl","cld","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","q","cl","q","cl","q1","cl","q1","cl","q2","cl","q2","cl","cld","cl","cld","cl","cld2","cl","cld2","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","q2","cl","q2","cl","q2","cl","q2","cl","q2","cl","q2","cl","q2","cl","q2","cl","q2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","cld2","cl","q","cl","q","cl","q","cl","q1","cl","q1","cl","q1","cl","cld","cl","cld","cl","cld","cl","v2","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","q","cl","q","cl","q1","cl","q1","cl","cld","cl","cld","cl","v","cl","vc","cl","v1"],["q","q2","q","q2","q1","q2","q1","q2","q2","v","q2","vc","cld","cld2","cld","cld2","cld2","v","cld2","vc","q","v","q","vc","q1","v","q1","vc","cld","v","cld","vc","q","q2","q","q2","q","q2","q1","q2","q1","q2","q1","q2","q2","v2","q2","v","q2","v3","cld","cld2","cld","cld2","cld","cld2","cld2","v2","cld2","v","cld2","v3","q","v2","q1","v2","cld","v2","q","v","q","v3","q1","v","q1","v3","cld","v","cld","v3","q","q2","q","q2","q1","q2","q1","q2","q2","v","q2","vc","cld","cld2","cld","cld2","cld2","v","cld2","vc","q","v","q","vc","q1","v","q1","vc","cld","v","cld","vc","q2","v","q2","v2","q2","v1","q2","v","q2","vc","q2","v","q2","vc","q2","v","q2","vc","cld2","v","cld2","v2","cld2","v1","cld2","v","cld2","vc","cld2","v","cld2","vc","cld2","v","cld2","vc","q","v","q","v2","q","v1","q1","v","q1","v2","q1","v1","cld","v","cld","v2","cld","v1","v2","","q","v","q","vc","q1","v","q1","vc","cld","v","cld","vc","q","v","q","vc","q1","v","q1","vc","cld","v","cld","vc","q","v","q","vc","q1","v","q1","vc","cld","v","cld","vc","v","","vc","","v1",""],["q2","v","q2","vc","q2","v","q2","vc","v","vp2","vc","vp2","cld2","v","cld2","vc","v","vp2","vc","vp2","v","vp2","vc","vp2","v","vp2","vc","vp2","v","vp2","vc","vp2","q2","v","q2","v2","q2","v1","q2","v","q2","v2","q2","v1","v2","v3","v","v3","v3","vc","cld2","v","cld2","v2","cld2","v1","v2","v3","v","v3","v3","vc","v2","v3","v2","v3","v2","v3","v","v3","v3","vc","v","v3","v3","vc","v","v3","v3","vc","q2","v","q2","vc","q2","v","q2","vc","v","vt2","vc","vt2","cld2","v","cld2","vc","v","vt2","vc","vt2","v","vt2","vc","vt2","v","vt2","vc","vt2","v","vt2","vc","vt2","v","v2","v2","vc","v1","v2","v","vp","vc","vp","v","vt","vc","vt","v","vss","vc","vss","v","v2","v2","vc","v1","v2","v","vp","vc","vp","v","vt","vc","vt","v","vss","vc","vss","v","v2","v2","vc","v1","v2","v","v2","v2","vc","v1","v2","v","v2","v2","vc","v1","v2","","","v","vp","vc","vp","v","vp","vc","vp","v","vp","vc","vp","v","vt","vc","vt","v","vt","vc","vt","v","vt","vc","vt","v","vss","vc","vss","v","vss","vc","vss","v","vss","vc","vss","","","","","",""],["v","vp","vc","vp","v","vp","vc","vp","vp2","","vp2","","v","vp","vc","vp","vp2","","vp2","","vp2","","vp2","","vp2","","vp2","","vp2","","vp2","","v","v2","v2","v3","v1","v2","v","v2","v2","v3","v1","v2","v3","","v3","","vc","","v","v2","v2","v3","v1","v2","v3","","v3","","vc","","v3","","v3","","v3","","v3","","vc","","v3","","vc","","v3","","vc","","v","vt","vc","vt","v","vt","vc","vt","vt2","","vt2","","v","vt","vc","vt","vt2","","vt2","","vt2","","vt2","","vt2","","vt2","","vt2","","vt2","","v2","","vc","","v2","","vp","","vp","","vt","","vt","","vss","","vss","","v2","","vc","","v2","","vp","","vp","","vt","","vt","","vss","","vss","","v2","","vc","","v2","","v2","","vc","","v2","","v2","","vc","","v2","","","","vp","","vp","","vp","","vp","","vp","","vp","","vt","","vt","","vt","","vt","","vt","","vt","","vss","","vss","","vss","","vss","","vss","","vss","","","","","","",""],["vp","vp2","vp","vp2","vp","vp2","vp","vp2","","","","","vp","vp2","vp","vp2","","","","","","","","","","","","","","","","","v2","v3","v3","vc","v2","v3","v2","v3","v3","vc","v2","v3","","","","","","","v2","v3","v3","vc","v2","v3","","","","","","","","","","","","","","","","","","","","","","","","","vt","vt2","vt","vt2","vt","vt2","vt","vt2","","","","","vt","vt2","vt","vt2","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["vp2","","vp2","","vp2","","vp2","","","","","","vp2","","vp2","","","","","","","","","","","","","","","","","","v3","","vc","","v3","","v3","","vc","","v3","","","","","","","","v3","","vc","","v3","","","","","","","","","","","","","","","","","","","","","","","","","","vt2","","vt2","","vt2","","vt2","","","","","","vt2","","vt2","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],[3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>par1<\/th>\n      <th>par2<\/th>\n      <th>par3<\/th>\n      <th>par4<\/th>\n      <th>par5<\/th>\n      <th>par6<\/th>\n      <th>par7<\/th>\n      <th>ncmt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Another popular parameterization is in terms of micro-constants. rxode2
assumes compartment <code>1</code> is the central compartment. The elimination
constant would be specified by <code>K</code>, <code>Ke</code> or <code>Kel</code>. Some example translations are below:</p>
<div id="htmlwidget-17d43d65ccad1e1c3736" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-17d43d65ccad1e1c3736">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1"],["v","k","vc","k","v1","k","v","ke","vc","ke","v1","ke","v","kel","vc","kel","v1","kel","v","k","vc","k","v1","k","v","ke","vc","ke","v1","ke","v","kel","vc","kel","v1","kel","v","k","vc","k","v1","k","v","ke","vc","ke","v1","ke","v","kel","vc","kel","v1","kel"],["k","k12","k","k12","k","k12","ke","k12","ke","k12","ke","k12","kel","k12","kel","k12","kel","k12","k","k12","k","k12","k","k12","ke","k12","ke","k12","ke","k12","kel","k12","kel","k12","kel","k12","k","","k","","k","","ke","","ke","","ke","","kel","","kel","","kel",""],["k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","k12","k21","","","","","","","","","","","","","","","","","",""],["k21","k13","k21","k13","k21","k13","k21","k13","k21","k13","k21","k13","k21","k13","k21","k13","k21","k13","k21","","k21","","k21","","k21","","k21","","k21","","k21","","k21","","k21","","","","","","","","","","","","","","","","","","",""],["k13","k31","k13","k31","k13","k31","k13","k31","k13","k31","k13","k31","k13","k31","k13","k31","k13","k31","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["k31","","k31","","k31","","k31","","k31","","k31","","k31","","k31","","k31","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>par1<\/th>\n      <th>par2<\/th>\n      <th>par3<\/th>\n      <th>par4<\/th>\n      <th>par5<\/th>\n      <th>par6<\/th>\n      <th>par7<\/th>\n      <th>ncmt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The last parameterization possible is using <code>alpha</code> and <code>V</code> and/or
<code>A</code>/<code>B</code>/<code>C</code>. Some example translations are below:</p>
<div id="htmlwidget-5449e569dc804888b324" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5449e569dc804888b324">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","v","ka","vc","ka","v1","ka","a","ka","a","ka","a"],["v","alpha","vc","alpha","v1","alpha","v","alpha","vc","alpha","v1","alpha","v","alpha","vc","alpha","v1","alpha","a","alpha","a","alpha","a","alpha"],["alpha","beta","alpha","beta","alpha","beta","alpha","beta","alpha","beta","alpha","beta","alpha","","alpha","","alpha","","alpha","b","alpha","b","alpha",""],["beta","aob","beta","aob","beta","aob","beta","k21","beta","k21","beta","k21","","","","","","","b","beta","b","beta","",""],["aob","","aob","","aob","","k21","","k21","","k21","","","","","","","","beta","c","beta","","",""],["","","","","","","","","","","","","","","","","","","c","gamma","","","",""],["","","","","","","","","","","","","","","","","","","gamma","","","","",""],[1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,2,2,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>par1<\/th>\n      <th>par2<\/th>\n      <th>par3<\/th>\n      <th>par4<\/th>\n      <th>par5<\/th>\n      <th>par6<\/th>\n      <th>par7<\/th>\n      <th>ncmt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Once the <code>linCmt()</code> sleuthing is complete, the <code>1</code>, <code>2</code> or <code>3</code>
compartment model solution is used as the value of <code>linCmt()</code>.</p>
<p>The compartments where you can dose in a linear solved system are
<code>depot</code> and <code>central</code> when there is an linear absorption constant in
the model <code>ka</code>. Without any additional ODEs, these compartments are
numbered <code>depot=1</code> and <code>central=2</code>.</p>
<p>When the absorption constant <code>ka</code> is missing, you may only dose to the
<code>central</code> compartment. Without any additional ODEs the compartment
number is <code>central=1</code>.</p>
<p>These compartments take the same sort of events that a ODE model can
take, and are discussed in the <a href="rxode2-events.html">rxode2 events
vignette</a>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="examples.html#cb213-1" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb213-2"><a href="examples.html#cb213-2" aria-hidden="true"></a>    ke &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb213-3"><a href="examples.html#cb213-3" aria-hidden="true"></a>    V &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb213-4"><a href="examples.html#cb213-4" aria-hidden="true"></a>    ipre &lt;-<span class="st"> </span><span class="kw">linCmt</span>();</span>
<span id="cb213-5"><a href="examples.html#cb213-5" aria-hidden="true"></a>})</span>
<span id="cb213-6"><a href="examples.html#cb213-6" aria-hidden="true"></a>mod</span></code></pre></div>
<pre><code>#&gt; rxode2 2.0.8 model named rx_3dc65ff0a81211c79892db87f54bcd81 model (✔ ready). 
#&gt; x$stateExtra: central
#&gt; x$params: ke, V
#&gt; x$lhs: ipre</code></pre>
<p>This then acts as an ODE model; You specify a dose to the depot
compartment and then solve the system:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="examples.html#cb215-1" aria-hidden="true"></a>et  &lt;-<span class="st"> </span><span class="kw">et</span>(<span class="dt">amt=</span><span class="dv">10</span>,<span class="dt">time=</span><span class="dv">0</span>,<span class="dt">cmt=</span>depot) <span class="op">%&gt;%</span></span>
<span id="cb215-2"><a href="examples.html#cb215-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">et</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dt">length.out=</span><span class="dv">50</span>))</span>
<span id="cb215-3"><a href="examples.html#cb215-3" aria-hidden="true"></a>cmt1 &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(mod,et,<span class="dt">params=</span><span class="kw">c</span>(<span class="dt">ke=</span><span class="fl">0.5</span>))</span>
<span id="cb215-4"><a href="examples.html#cb215-4" aria-hidden="true"></a>cmt1</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters (x$params): ──
#&gt;  ke   V 
#&gt; 0.5 1.0 
#&gt; ── Initial Conditions (x$inits): ──
#&gt; named numeric(0)
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 50 × 2
#&gt;    time  ipre
#&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 0     10   
#&gt; 2 0.490  7.83
#&gt; 3 0.980  6.13
#&gt; 4 1.47   4.80
#&gt; 5 1.96   3.75
#&gt; 6 2.45   2.94
#&gt; # … with 44 more rows</code></pre>
</div>
<div id="mixing-solved-systems-and-odes" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Mixing Solved Systems and ODEs<a href="examples.html#mixing-solved-systems-and-odes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to pure ODEs, you may mix solved systems and ODEs. The
prior 2-compartment indirect response model can be simplified with a
<code>linCmt()</code> function:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="examples.html#cb217-1" aria-hidden="true"></a><span class="kw">library</span>(rxode2)</span>
<span id="cb217-2"><a href="examples.html#cb217-2" aria-hidden="true"></a><span class="co">## Setup example model</span></span>
<span id="cb217-3"><a href="examples.html#cb217-3" aria-hidden="true"></a>mod1 &lt;-<span class="kw">rxode2</span>({</span>
<span id="cb217-4"><a href="examples.html#cb217-4" aria-hidden="true"></a>    C2 =<span class="st"> </span>centr<span class="op">/</span>V2;</span>
<span id="cb217-5"><a href="examples.html#cb217-5" aria-hidden="true"></a>    C3 =<span class="st"> </span>peri<span class="op">/</span>V3;</span>
<span id="cb217-6"><a href="examples.html#cb217-6" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(depot) =<span class="op">-</span>KA<span class="op">*</span>depot;</span>
<span id="cb217-7"><a href="examples.html#cb217-7" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(centr) =<span class="st"> </span>KA<span class="op">*</span>depot <span class="op">-</span><span class="st"> </span>CL<span class="op">*</span>C2 <span class="op">-</span><span class="st"> </span>Q<span class="op">*</span>C2 <span class="op">+</span><span class="st"> </span>Q<span class="op">*</span>C3;</span>
<span id="cb217-8"><a href="examples.html#cb217-8" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(peri)  =<span class="st">                    </span>Q<span class="op">*</span>C2 <span class="op">-</span><span class="st"> </span>Q<span class="op">*</span>C3;</span>
<span id="cb217-9"><a href="examples.html#cb217-9" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(eff)  =<span class="st"> </span>Kin <span class="op">-</span><span class="st"> </span>Kout<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>C2<span class="op">/</span>(EC50<span class="op">+</span>C2))<span class="op">*</span>eff;</span>
<span id="cb217-10"><a href="examples.html#cb217-10" aria-hidden="true"></a>});</span>
<span id="cb217-11"><a href="examples.html#cb217-11" aria-hidden="true"></a></span>
<span id="cb217-12"><a href="examples.html#cb217-12" aria-hidden="true"></a><span class="co">## Seup parameters and initial conditions</span></span>
<span id="cb217-13"><a href="examples.html#cb217-13" aria-hidden="true"></a></span>
<span id="cb217-14"><a href="examples.html#cb217-14" aria-hidden="true"></a>theta &lt;-</span>
<span id="cb217-15"><a href="examples.html#cb217-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">c</span>(<span class="dt">KA=</span><span class="fl">2.94E-01</span>, <span class="dt">CL=</span><span class="fl">1.86E+01</span>, <span class="dt">V2=</span><span class="fl">4.02E+01</span>, <span class="co"># central</span></span>
<span id="cb217-16"><a href="examples.html#cb217-16" aria-hidden="true"></a>      <span class="dt">Q=</span><span class="fl">1.05E+01</span>,  <span class="dt">V3=</span><span class="fl">2.97E+02</span>,              <span class="co"># peripheral</span></span>
<span id="cb217-17"><a href="examples.html#cb217-17" aria-hidden="true"></a>      <span class="dt">Kin=</span><span class="dv">1</span>, <span class="dt">Kout=</span><span class="dv">1</span>, <span class="dt">EC50=</span><span class="dv">200</span>)               <span class="co"># effects</span></span>
<span id="cb217-18"><a href="examples.html#cb217-18" aria-hidden="true"></a></span>
<span id="cb217-19"><a href="examples.html#cb217-19" aria-hidden="true"></a>inits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">eff=</span><span class="dv">1</span>);</span>
<span id="cb217-20"><a href="examples.html#cb217-20" aria-hidden="true"></a></span>
<span id="cb217-21"><a href="examples.html#cb217-21" aria-hidden="true"></a><span class="co">## Setup dosing event information</span></span>
<span id="cb217-22"><a href="examples.html#cb217-22" aria-hidden="true"></a>ev &lt;-<span class="st"> </span><span class="kw">eventTable</span>(<span class="dt">amount.units=</span><span class="st">&quot;mg&quot;</span>, <span class="dt">time.units=</span><span class="st">&quot;hours&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb217-23"><a href="examples.html#cb217-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.dosing</span>(<span class="dt">dose=</span><span class="dv">10000</span>, <span class="dt">nbr.doses=</span><span class="dv">10</span>, <span class="dt">dosing.interval=</span><span class="dv">12</span>) <span class="op">%&gt;%</span></span>
<span id="cb217-24"><a href="examples.html#cb217-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.dosing</span>(<span class="dt">dose=</span><span class="dv">20000</span>, <span class="dt">nbr.doses=</span><span class="dv">5</span>, <span class="dt">start.time=</span><span class="dv">120</span>,<span class="dt">dosing.interval=</span><span class="dv">24</span>) <span class="op">%&gt;%</span></span>
<span id="cb217-25"><a href="examples.html#cb217-25" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.sampling</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">240</span>);</span>
<span id="cb217-26"><a href="examples.html#cb217-26" aria-hidden="true"></a></span>
<span id="cb217-27"><a href="examples.html#cb217-27" aria-hidden="true"></a><span class="co">## Setup a mixed solved/ode system:</span></span>
<span id="cb217-28"><a href="examples.html#cb217-28" aria-hidden="true"></a>mod2 &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb217-29"><a href="examples.html#cb217-29" aria-hidden="true"></a>    <span class="co">## the order of variables do not matter, the type of compartmental</span></span>
<span id="cb217-30"><a href="examples.html#cb217-30" aria-hidden="true"></a>    <span class="co">## model is determined by the parameters specified.</span></span>
<span id="cb217-31"><a href="examples.html#cb217-31" aria-hidden="true"></a>    C2   =<span class="st"> </span><span class="kw">linCmt</span>(KA, CL, V2, Q, V3);</span>
<span id="cb217-32"><a href="examples.html#cb217-32" aria-hidden="true"></a>    <span class="kw">eff</span>(<span class="dv">0</span>) =<span class="st"> </span><span class="dv">1</span>  <span class="co">## This specifies that the effect compartment starts at 1.</span></span>
<span id="cb217-33"><a href="examples.html#cb217-33" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(eff) =<span class="st">  </span>Kin <span class="op">-</span><span class="st"> </span>Kout<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>C2<span class="op">/</span>(EC50<span class="op">+</span>C2))<span class="op">*</span>eff;</span>
<span id="cb217-34"><a href="examples.html#cb217-34" aria-hidden="true"></a>})</span></code></pre></div>
<p>This allows the indirect response model above to assign the
2-compartment model to the <code>C2</code> variable and the used in the indirect
response model.</p>
<p>When mixing the solved systems and the ODEs, the solved system’s
compartment is always the last compartment. This is because the
solved system technically isn’t a compartment to be solved. Adding
the dosing compartment to the end will not interfere with the actual
ODE to be solved.</p>
<p>Therefore,in the two-compartment indirect response model, the effect
compartment is compartment #1 while the PK dosing compartment for the
depot is compartment #2.</p>
<p>This compartment model requires a new event table since the
compartment number changed:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="examples.html#cb218-1" aria-hidden="true"></a>ev &lt;-<span class="st"> </span><span class="kw">eventTable</span>(<span class="dt">amount.units=</span><span class="st">&#39;mg&#39;</span>, <span class="dt">time.units=</span><span class="st">&#39;hours&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb218-2"><a href="examples.html#cb218-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.dosing</span>(<span class="dt">dose=</span><span class="dv">10000</span>, <span class="dt">nbr.doses=</span><span class="dv">10</span>, <span class="dt">dosing.interval=</span><span class="dv">12</span>,<span class="dt">dosing.to=</span><span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb218-3"><a href="examples.html#cb218-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.dosing</span>(<span class="dt">dose=</span><span class="dv">20000</span>, <span class="dt">nbr.doses=</span><span class="dv">5</span>, <span class="dt">start.time=</span><span class="dv">120</span>,<span class="dt">dosing.interval=</span><span class="dv">24</span>,<span class="dt">dosing.to=</span><span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb218-4"><a href="examples.html#cb218-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">add.sampling</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">240</span>);</span></code></pre></div>
<p>This can be solved with the following command:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="examples.html#cb219-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span>mod2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">solve</span>(theta, ev)</span>
<span id="cb219-2"><a href="examples.html#cb219-2" aria-hidden="true"></a><span class="kw">print</span>(x)</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters ($params): ──
#&gt;      CL      V2       Q      V3      KA     Kin    Kout    EC50 
#&gt;  18.600  40.200  10.500 297.000   0.294   1.000   1.000 200.000 
#&gt; ── Initial Conditions ($inits): ──
#&gt; eff 
#&gt;   1 
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 241 × 3
#&gt;   time    C2   eff
#&gt;    [h] &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1    0 249.   1   
#&gt; 2    1 121.   1.35
#&gt; 3    2  60.3  1.38
#&gt; 4    3  31.0  1.28
#&gt; 5    4  17.0  1.18
#&gt; 6    5  10.2  1.11
#&gt; # … with 235 more rows</code></pre>
<p>Note this solving did not require specifying the effect compartment
initial condition to be <code>1</code>. Rather, this is already pre-specified by <code>eff(0)=1</code>.</p>
<p>This can be solved for different initial conditions easily:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="examples.html#cb221-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span>mod2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">solve</span>(theta, ev,<span class="kw">c</span>(<span class="dt">eff=</span><span class="dv">2</span>))</span>
<span id="cb221-2"><a href="examples.html#cb221-2" aria-hidden="true"></a><span class="kw">print</span>(x)</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters ($params): ──
#&gt;      CL      V2       Q      V3      KA     Kin    Kout    EC50 
#&gt;  18.600  40.200  10.500 297.000   0.294   1.000   1.000 200.000 
#&gt; ── Initial Conditions ($inits): ──
#&gt; eff 
#&gt;   2 
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 241 × 3
#&gt;   time    C2   eff
#&gt;    [h] &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1    0 249.   2   
#&gt; 2    1 121.   1.93
#&gt; 3    2  60.3  1.67
#&gt; 4    3  31.0  1.41
#&gt; 5    4  17.0  1.23
#&gt; 6    5  10.2  1.13
#&gt; # … with 235 more rows</code></pre>
<p>The rxode2 detective also does not require you to specify the variables
in the <code>linCmt()</code> function if they are already defined in the block.
Therefore, the following function will also work to solve the same
system.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="examples.html#cb223-1" aria-hidden="true"></a>mod3 &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb223-2"><a href="examples.html#cb223-2" aria-hidden="true"></a>    KA=<span class="fl">2.94E-01</span>;</span>
<span id="cb223-3"><a href="examples.html#cb223-3" aria-hidden="true"></a>    CL=<span class="fl">1.86E+01</span>;</span>
<span id="cb223-4"><a href="examples.html#cb223-4" aria-hidden="true"></a>    V2=<span class="fl">4.02E+01</span>;</span>
<span id="cb223-5"><a href="examples.html#cb223-5" aria-hidden="true"></a>    Q=<span class="fl">1.05E+01</span>;</span>
<span id="cb223-6"><a href="examples.html#cb223-6" aria-hidden="true"></a>    V3=<span class="fl">2.97E+02</span>;</span>
<span id="cb223-7"><a href="examples.html#cb223-7" aria-hidden="true"></a>    Kin=<span class="dv">1</span>;</span>
<span id="cb223-8"><a href="examples.html#cb223-8" aria-hidden="true"></a>    Kout=<span class="dv">1</span>;</span>
<span id="cb223-9"><a href="examples.html#cb223-9" aria-hidden="true"></a>    EC50=<span class="dv">200</span>;</span>
<span id="cb223-10"><a href="examples.html#cb223-10" aria-hidden="true"></a>    <span class="co">## The linCmt() picks up the variables from above</span></span>
<span id="cb223-11"><a href="examples.html#cb223-11" aria-hidden="true"></a>    C2   =<span class="st"> </span><span class="kw">linCmt</span>();</span>
<span id="cb223-12"><a href="examples.html#cb223-12" aria-hidden="true"></a>    <span class="kw">eff</span>(<span class="dv">0</span>) =<span class="st"> </span><span class="dv">1</span>  <span class="co">## This specifies that the effect compartment starts at 1.</span></span>
<span id="cb223-13"><a href="examples.html#cb223-13" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(eff) =<span class="st">  </span>Kin <span class="op">-</span><span class="st"> </span>Kout<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>C2<span class="op">/</span>(EC50<span class="op">+</span>C2))<span class="op">*</span>eff;</span>
<span id="cb223-14"><a href="examples.html#cb223-14" aria-hidden="true"></a>})</span>
<span id="cb223-15"><a href="examples.html#cb223-15" aria-hidden="true"></a></span>
<span id="cb223-16"><a href="examples.html#cb223-16" aria-hidden="true"></a>x &lt;-<span class="st"> </span>mod3 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">solve</span>(ev)</span>
<span id="cb223-17"><a href="examples.html#cb223-17" aria-hidden="true"></a><span class="kw">print</span>(x)</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters ($params): ──
#&gt;      KA      CL      V2       Q      V3     Kin    Kout    EC50 
#&gt;   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000 
#&gt; ── Initial Conditions ($inits): ──
#&gt; eff 
#&gt;   1 
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 241 × 3
#&gt;   time    C2   eff
#&gt;    [h] &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1    0 249.   1   
#&gt; 2    1 121.   1.35
#&gt; 3    2  60.3  1.38
#&gt; 4    3  31.0  1.28
#&gt; 5    4  17.0  1.18
#&gt; 6    5  10.2  1.11
#&gt; # … with 235 more rows</code></pre>
<p>Note that you do not specify the parameters when solving the system
since they are built into the model, but you can override the parameters:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="examples.html#cb225-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span>mod3 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">solve</span>(<span class="kw">c</span>(<span class="dt">KA=</span><span class="dv">10</span>),ev)</span>
<span id="cb225-2"><a href="examples.html#cb225-2" aria-hidden="true"></a><span class="kw">print</span>(x)</span></code></pre></div>
<pre><code>#&gt; ── Solved rxode2 object ──
#&gt; ── Parameters ($params): ──
#&gt;    KA    CL    V2     Q    V3   Kin  Kout  EC50 
#&gt;  10.0  18.6  40.2  10.5 297.0   1.0   1.0 200.0 
#&gt; ── Initial Conditions ($inits): ──
#&gt; eff 
#&gt;   1 
#&gt; ── First part of data (object): ──
#&gt; # A tibble: 241 × 3
#&gt;   time    C2   eff
#&gt;    [h] &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1    0 249.   1   
#&gt; 2    1 121.   1.35
#&gt; 3    2  60.3  1.38
#&gt; 4    3  31.0  1.28
#&gt; 5    4  17.0  1.18
#&gt; 6    5  10.2  1.11
#&gt; # … with 235 more rows</code></pre>
</div>
<div id="weight-based-dosing" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Weight based dosing<a href="examples.html#weight-based-dosing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is an example model for weight based dosing of
daptomycin. Daptomycin is a cyclic lipopeptide antibiotic from
fermented <em>Streptomyces roseosporus</em>.</p>
<p>There are 3 stages for weight-based dosing simulations:
- Create rxode2 model
- Simulate Covariates
- Create event table with weight-based dosing (merged back to covariates)</p>
<div id="creating-a-2-compartment-model-in-rxode2" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Creating a 2-compartment model in rxode2<a href="examples.html#creating-a-2-compartment-model-in-rxode2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="examples.html#cb227-1" aria-hidden="true"></a><span class="kw">library</span>(rxode2)</span>
<span id="cb227-2"><a href="examples.html#cb227-2" aria-hidden="true"></a></span>
<span id="cb227-3"><a href="examples.html#cb227-3" aria-hidden="true"></a><span class="co">## Note the time covariate is not included in the simulation</span></span>
<span id="cb227-4"><a href="examples.html#cb227-4" aria-hidden="true"></a>m1 &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb227-5"><a href="examples.html#cb227-5" aria-hidden="true"></a>  CL <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-0.2</span><span class="op">*</span>SEX)<span class="op">*</span>(<span class="fl">0.807+0.00514</span><span class="op">*</span>(CRCL<span class="fl">-91.2</span>))<span class="op">*</span><span class="kw">exp</span>(eta.cl)</span>
<span id="cb227-6"><a href="examples.html#cb227-6" aria-hidden="true"></a>  V1 <span class="op">~</span><span class="st"> </span><span class="fl">4.8</span><span class="op">*</span><span class="kw">exp</span>(eta.v1)</span>
<span id="cb227-7"><a href="examples.html#cb227-7" aria-hidden="true"></a>  Q <span class="op">~</span><span class="st"> </span>(<span class="fl">3.46+0.0593</span><span class="op">*</span>(WT<span class="fl">-75.1</span>))<span class="op">*</span><span class="kw">exp</span>(eta.q);</span>
<span id="cb227-8"><a href="examples.html#cb227-8" aria-hidden="true"></a>  V2 <span class="op">~</span><span class="st"> </span><span class="fl">1.93</span><span class="op">*</span>(<span class="fl">3.13+0.0458</span><span class="op">*</span>(WT<span class="fl">-75.1</span>))<span class="op">*</span><span class="kw">exp</span>(eta.v2)</span>
<span id="cb227-9"><a href="examples.html#cb227-9" aria-hidden="true"></a>  A1 <span class="op">~</span><span class="st"> </span>centr;</span>
<span id="cb227-10"><a href="examples.html#cb227-10" aria-hidden="true"></a>  A2 <span class="op">~</span><span class="st"> </span>peri;</span>
<span id="cb227-11"><a href="examples.html#cb227-11" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(centr) <span class="op">~</span><span class="st"> </span><span class="op">-</span><span class="st"> </span>A1<span class="op">*</span>(CL<span class="op">/</span>V1 <span class="op">+</span><span class="st"> </span>Q<span class="op">/</span>V1) <span class="op">+</span><span class="st"> </span>A2<span class="op">*</span>Q<span class="op">/</span>V2;</span>
<span id="cb227-12"><a href="examples.html#cb227-12" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(peri) <span class="op">~</span><span class="st"> </span>A1<span class="op">*</span>Q<span class="op">/</span>V1 <span class="op">-</span><span class="st"> </span>A2<span class="op">*</span>Q<span class="op">/</span>V2;</span>
<span id="cb227-13"><a href="examples.html#cb227-13" aria-hidden="true"></a>  DV =<span class="st"> </span>centr <span class="op">/</span><span class="st"> </span>V1 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prop.err)</span>
<span id="cb227-14"><a href="examples.html#cb227-14" aria-hidden="true"></a>})</span></code></pre></div>
</div>
<div id="simulating-covariates" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Simulating Covariates<a href="examples.html#simulating-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This simulation correlates age, sex, and weight. Since we will be
using weight based dosing, this needs to be simulated first</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="examples.html#cb228-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb228-2"><a href="examples.html#cb228-2" aria-hidden="true"></a><span class="kw">rxSetSeed</span>(<span class="dv">42</span>)</span>
<span id="cb228-3"><a href="examples.html#cb228-3" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb228-4"><a href="examples.html#cb228-4" aria-hidden="true"></a>nsub=<span class="dv">30</span></span>
<span id="cb228-5"><a href="examples.html#cb228-5" aria-hidden="true"></a><span class="co">### Simulate Weight based on age and gender</span></span>
<span id="cb228-6"><a href="examples.html#cb228-6" aria-hidden="true"></a>AGE&lt;-<span class="kw">round</span>(<span class="kw">runif</span>(nsub,<span class="dt">min=</span><span class="dv">18</span>,<span class="dt">max=</span><span class="dv">70</span>))</span>
<span id="cb228-7"><a href="examples.html#cb228-7" aria-hidden="true"></a>SEX&lt;-<span class="kw">round</span>(<span class="kw">runif</span>(nsub,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>))</span>
<span id="cb228-8"><a href="examples.html#cb228-8" aria-hidden="true"></a>HTm&lt;-<span class="kw">round</span>(<span class="kw">rnorm</span>(nsub,<span class="fl">176.3</span>,<span class="fl">0.17</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">4482</span>)),<span class="dt">digits=</span><span class="dv">1</span>)</span>
<span id="cb228-9"><a href="examples.html#cb228-9" aria-hidden="true"></a>HTf&lt;-<span class="kw">round</span>(<span class="kw">rnorm</span>(nsub,<span class="fl">162.2</span>,<span class="fl">0.16</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">4857</span>)),<span class="dt">digits=</span><span class="dv">1</span>)</span>
<span id="cb228-10"><a href="examples.html#cb228-10" aria-hidden="true"></a>WTm&lt;-<span class="kw">round</span>(<span class="kw">exp</span>(<span class="fl">3.28+1.92</span><span class="op">*</span><span class="kw">log</span>(HTm<span class="op">/</span><span class="dv">100</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">rnorm</span>(nsub,<span class="dv">0</span>,<span class="fl">0.14</span>)),<span class="dt">digits=</span><span class="dv">1</span>)</span>
<span id="cb228-11"><a href="examples.html#cb228-11" aria-hidden="true"></a>WTf&lt;-<span class="kw">round</span>(<span class="kw">exp</span>(<span class="fl">3.49+1.45</span><span class="op">*</span><span class="kw">log</span>(HTf<span class="op">/</span><span class="dv">100</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">rnorm</span>(nsub,<span class="dv">0</span>,<span class="fl">0.17</span>)),<span class="dt">digits=</span><span class="dv">1</span>)</span>
<span id="cb228-12"><a href="examples.html#cb228-12" aria-hidden="true"></a>WT&lt;-<span class="kw">ifelse</span>(SEX<span class="op">==</span><span class="dv">1</span>,WTf,WTm)</span>
<span id="cb228-13"><a href="examples.html#cb228-13" aria-hidden="true"></a>CRCL&lt;-<span class="kw">round</span>(<span class="kw">runif</span>(nsub,<span class="dv">30</span>,<span class="dv">140</span>))</span>
<span id="cb228-14"><a href="examples.html#cb228-14" aria-hidden="true"></a><span class="co">## id is in lower case to match the event table</span></span>
<span id="cb228-15"><a href="examples.html#cb228-15" aria-hidden="true"></a>cov.df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id=</span><span class="kw">seq_along</span>(AGE), <span class="dt">AGE=</span>AGE, <span class="dt">SEX=</span>SEX, <span class="dt">WT=</span>WT, <span class="dt">CRCL=</span>CRCL)</span>
<span id="cb228-16"><a href="examples.html#cb228-16" aria-hidden="true"></a><span class="kw">print</span>(cov.df)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 30 x 5
#&gt;       id   AGE   SEX    WT  CRCL
#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1     1    66     1  49.4    83
#&gt;  2     2    67     1  52.5    79
#&gt;  3     3    33     0  97.9    37
#&gt;  4     4    61     1  63.8    66
#&gt;  5     5    51     0  71.8   127
#&gt;  6     6    45     1  69.6   132
#&gt;  7     7    56     0  61      73
#&gt;  8     8    25     0  57.7    47
#&gt;  9     9    52     1  58.7    65
#&gt; 10    10    55     1  73.1    64
#&gt; # ... with 20 more rows</code></pre>
</div>
<div id="creating-weight-based-event-table" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Creating weight based event table<a href="examples.html#creating-weight-based-event-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="examples.html#cb230-1" aria-hidden="true"></a>s&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dt">by=</span><span class="dv">1</span>))</span>
<span id="cb230-2"><a href="examples.html#cb230-2" aria-hidden="true"></a>s &lt;-<span class="st"> </span><span class="kw">lapply</span>(s, <span class="cf">function</span>(x){.x &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>x; <span class="kw">c</span>(x <span class="op">-</span><span class="st"> </span>.x, x <span class="op">+</span><span class="st"> </span>.x)})</span>
<span id="cb230-3"><a href="examples.html#cb230-3" aria-hidden="true"></a></span>
<span id="cb230-4"><a href="examples.html#cb230-4" aria-hidden="true"></a>e &lt;-<span class="st"> </span><span class="kw">et</span>() <span class="op">%&gt;%</span></span>
<span id="cb230-5"><a href="examples.html#cb230-5" aria-hidden="true"></a><span class="st">    </span><span class="co">## Specify the id and weight based dosing from covariate data.frame</span></span>
<span id="cb230-6"><a href="examples.html#cb230-6" aria-hidden="true"></a><span class="st">    </span><span class="co">## This requires rxode2 XXX </span></span>
<span id="cb230-7"><a href="examples.html#cb230-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">et</span>(<span class="dt">id=</span>cov.df<span class="op">$</span>id, <span class="dt">amt=</span><span class="dv">6</span><span class="op">*</span>cov.df<span class="op">$</span>WT, <span class="dt">rate=</span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span>cov.df<span class="op">$</span>WT) <span class="op">%&gt;%</span></span>
<span id="cb230-8"><a href="examples.html#cb230-8" aria-hidden="true"></a><span class="st">    </span><span class="co">## Sampling is added for each ID</span></span>
<span id="cb230-9"><a href="examples.html#cb230-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">et</span>(s) <span class="op">%&gt;%</span></span>
<span id="cb230-10"><a href="examples.html#cb230-10" aria-hidden="true"></a><span class="st">    </span>as.data.frame <span class="op">%&gt;%</span></span>
<span id="cb230-11"><a href="examples.html#cb230-11" aria-hidden="true"></a><span class="st">    </span><span class="co">## Merge the event table with the covarite information</span></span>
<span id="cb230-12"><a href="examples.html#cb230-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">merge</span>(cov.df, <span class="dt">by=</span><span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb230-13"><a href="examples.html#cb230-13" aria-hidden="true"></a><span class="st">    </span>as_tibble</span>
<span id="cb230-14"><a href="examples.html#cb230-14" aria-hidden="true"></a></span>
<span id="cb230-15"><a href="examples.html#cb230-15" aria-hidden="true"></a></span>
<span id="cb230-16"><a href="examples.html#cb230-16" aria-hidden="true"></a>e</span></code></pre></div>
<pre><code>#&gt; # A tibble: 900 x 12
#&gt;       id    low  time   high cmt         amt  rate  evid   AGE   SEX    WT  CRCL
#&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1     1  0     0      0     (obs)       NA    NA      0    66     1  49.4    83
#&gt;  2     1 NA     0     NA     (default)  296.  296.     1    66     1  49.4    83
#&gt;  3     1  0.225 0.246  0.275 (obs)       NA    NA      0    66     1  49.4    83
#&gt;  4     1  0.45  0.516  0.55  (obs)       NA    NA      0    66     1  49.4    83
#&gt;  5     1  0.675 0.729  0.825 (obs)       NA    NA      0    66     1  49.4    83
#&gt;  6     1  0.9   0.921  1.1   (obs)       NA    NA      0    66     1  49.4    83
#&gt;  7     1  1.35  1.42   1.65  (obs)       NA    NA      0    66     1  49.4    83
#&gt;  8     1  1.8   1.82   2.2   (obs)       NA    NA      0    66     1  49.4    83
#&gt;  9     1  2.7   2.97   3.3   (obs)       NA    NA      0    66     1  49.4    83
#&gt; 10     1  3.6   3.87   4.4   (obs)       NA    NA      0    66     1  49.4    83
#&gt; # ... with 890 more rows</code></pre>
</div>
<div id="solving-daptomycin-simulation" class="section level3 hasAnchor" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Solving Daptomycin simulation<a href="examples.html#solving-daptomycin-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="examples.html#cb232-1" aria-hidden="true"></a>data &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(m1, e,</span>
<span id="cb232-2"><a href="examples.html#cb232-2" aria-hidden="true"></a>             <span class="co">## Lotri uses lower-triangular matrix rep. for named matrix</span></span>
<span id="cb232-3"><a href="examples.html#cb232-3" aria-hidden="true"></a>             <span class="dt">omega=</span><span class="kw">lotri</span>(eta.cl <span class="op">~</span><span class="st"> </span><span class="fl">.306</span>, </span>
<span id="cb232-4"><a href="examples.html#cb232-4" aria-hidden="true"></a>                         eta.q <span class="op">~</span><span class="fl">0.0652</span>,</span>
<span id="cb232-5"><a href="examples.html#cb232-5" aria-hidden="true"></a>                         eta.v1 <span class="op">~</span>.<span class="dv">567</span>,</span>
<span id="cb232-6"><a href="examples.html#cb232-6" aria-hidden="true"></a>                         eta.v2 <span class="op">~</span><span class="st"> </span><span class="fl">.191</span>),</span>
<span id="cb232-7"><a href="examples.html#cb232-7" aria-hidden="true"></a>             <span class="dt">sigma=</span><span class="kw">lotri</span>(prop.err <span class="op">~</span><span class="st"> </span><span class="fl">0.15</span>),</span>
<span id="cb232-8"><a href="examples.html#cb232-8" aria-hidden="true"></a>             <span class="dt">addDosing =</span> <span class="ot">TRUE</span>, <span class="dt">addCov =</span> <span class="ot">TRUE</span>)</span>
<span id="cb232-9"><a href="examples.html#cb232-9" aria-hidden="true"></a></span>
<span id="cb232-10"><a href="examples.html#cb232-10" aria-hidden="true"></a><span class="kw">print</span>(data)</span></code></pre></div>
<pre><code>#&gt; -- Solved rxode2 object --
#&gt; -- Parameters ($params): --
#&gt; # A tibble: 30 x 5
#&gt;    id    eta.cl eta.v1   eta.q  eta.v2
#&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1 1     -0.147  0.112  0.284  -0.187 
#&gt;  2 2     -0.280 -0.189  0.222  -0.843 
#&gt;  3 3      0.515  0.471  0.0387 -0.687 
#&gt;  4 4     -0.359  0.351  0.269   0.146 
#&gt;  5 5      0.565 -0.240  0.363   0.330 
#&gt;  6 6     -0.991  1.95   0.0108 -0.352 
#&gt;  7 7     -0.604 -1.19   0.0556  0.0760
#&gt;  8 8     -0.500 -0.212  0.315   0.902 
#&gt;  9 9      1.33   0.317 -0.0113  0.164 
#&gt; 10 10     0.201  0.390  0.182  -0.277 
#&gt; # ... with 20 more rows
#&gt; -- Initial Conditions ($inits): --
#&gt; centr  peri 
#&gt;     0     0 
#&gt; -- First part of data (object): --
#&gt; # A tibble: 900 x 9
#&gt;      id  evid   cmt   amt  time    DV   SEX    WT  CRCL
#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1     1     1  296. 0      0        1  49.4    83
#&gt; 2     1     0    NA   NA  0      0        1  49.4    83
#&gt; 3     1     0    NA   NA  0.246  7.72     1  49.4    83
#&gt; 4     1     0    NA   NA  0.516 21.2      1  49.4    83
#&gt; 5     1     0    NA   NA  0.729 27.4      1  49.4    83
#&gt; 6     1     0    NA   NA  0.921 39.1      1  49.4    83
#&gt; # ... with 894 more rows</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="examples.html#cb234-1" aria-hidden="true"></a><span class="kw">plot</span>(data, <span class="dt">log=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>#&gt; Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<pre><code>#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
<p><img src="rxode2-manual_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
<div id="daptomycin-reference" class="section level3 hasAnchor" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Daptomycin Reference<a href="examples.html#daptomycin-reference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This weight-based simulation is adapted from the Daptomycin article
below:</p>
<p>Dvorchik B, Arbeit RD, Chung J, Liu S, Knebel W, Kastrissios
H. Population pharmacokinetics of daptomycin. Antimicrob Agents
Che mother 2004; 48: 2799-2807. <a href="doi:(10.1128/AAC.48.8.2799-2807.2004" class="uri">doi:(10.1128/AAC.48.8.2799-2807.2004</a>)[<a href="https://dx.doi.org/10.1128%2FAAC.48.8.2799-2807.2004" class="uri">https://dx.doi.org/10.1128%2FAAC.48.8.2799-2807.2004</a>]</p>
<p>This simulation example was made available from the work of Sherwin Sy
with modifications by Matthew Fidler</p>
</div>
</div>
<div id="inter-occasion-and-other-nesting-examples" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Inter-occasion and other nesting examples<a href="examples.html#inter-occasion-and-other-nesting-examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>More than one level of nesting is possible in rxode2; In this example
we will be using the following uncertainties and sources of variability:</p>
<table>
<thead>
<tr class="header">
<th align="right">Level</th>
<th>Variable</th>
<th>Matrix specified</th>
<th>Integrated Matrix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Model uncertainty</td>
<td>NA</td>
<td><code>thetaMat</code></td>
<td><code>thetaMat</code></td>
</tr>
<tr class="even">
<td align="right">Investigator</td>
<td><code>inv.Cl</code>, <code>inv.Ka</code></td>
<td><code>omega</code></td>
<td><code>theta</code></td>
</tr>
<tr class="odd">
<td align="right">Subject</td>
<td><code>eta.Cl</code>, <code>eta.Ka</code></td>
<td><code>omega</code></td>
<td><code>omega</code></td>
</tr>
<tr class="even">
<td align="right">Eye</td>
<td><code>eye.Cl</code>, <code>eye.Ka</code></td>
<td><code>omega</code></td>
<td><code>omega</code></td>
</tr>
<tr class="odd">
<td align="right">Occasion</td>
<td><code>iov.Cl</code>, <code>occ.Ka</code></td>
<td><code>omega</code></td>
<td><code>omega</code></td>
</tr>
<tr class="even">
<td align="right">Unexplained Concentration</td>
<td><code>prop.sd</code></td>
<td><code>sigma</code></td>
<td><code>sigma</code></td>
</tr>
<tr class="odd">
<td align="right">Unexplained Effect</td>
<td><code>add.sd</code></td>
<td><code>sigma</code></td>
<td><code>sigma</code></td>
</tr>
</tbody>
</table>
<div id="event-table" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Event table<a href="examples.html#event-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This event table contains nesting variables:</p>
<ul>
<li>inv: investigator id</li>
<li>id: subject id</li>
<li>eye: eye id (left or right)</li>
<li>occ: occasion</li>
</ul>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="examples.html#cb238-1" aria-hidden="true"></a><span class="kw">library</span>(rxode2)</span>
<span id="cb238-2"><a href="examples.html#cb238-2" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb238-3"><a href="examples.html#cb238-3" aria-hidden="true"></a></span>
<span id="cb238-4"><a href="examples.html#cb238-4" aria-hidden="true"></a><span class="kw">et</span>(<span class="dt">amountUnits=</span><span class="st">&quot;mg&quot;</span>, <span class="dt">timeUnits=</span><span class="st">&quot;hours&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb238-5"><a href="examples.html#cb238-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">et</span>(<span class="dt">amt=</span><span class="dv">10000</span>, <span class="dt">addl=</span><span class="dv">9</span>,<span class="dt">ii=</span><span class="dv">12</span>,<span class="dt">cmt=</span><span class="st">&quot;depot&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb238-6"><a href="examples.html#cb238-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">et</span>(<span class="dt">time=</span><span class="dv">120</span>, <span class="dt">amt=</span><span class="dv">2000</span>, <span class="dt">addl=</span><span class="dv">4</span>, <span class="dt">ii=</span><span class="dv">14</span>, <span class="dt">cmt=</span><span class="st">&quot;depot&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb238-7"><a href="examples.html#cb238-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">et</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">240</span>, <span class="dt">by=</span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Assumes sampling when there is no dosing information</span></span>
<span id="cb238-8"><a href="examples.html#cb238-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">et</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">240</span>, <span class="dt">by=</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">## adds 0.1 for separate eye</span></span>
<span id="cb238-9"><a href="examples.html#cb238-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">et</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span></span>
<span id="cb238-10"><a href="examples.html#cb238-10" aria-hidden="true"></a><span class="st">  </span><span class="co">## Add an occasion per dose</span></span>
<span id="cb238-11"><a href="examples.html#cb238-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">occ=</span><span class="kw">cumsum</span>(<span class="op">!</span><span class="kw">is.na</span>(amt))) <span class="op">%&gt;%</span></span>
<span id="cb238-12"><a href="examples.html#cb238-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">occ=</span><span class="kw">ifelse</span>(occ <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, occ)) <span class="op">%&gt;%</span></span>
<span id="cb238-13"><a href="examples.html#cb238-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">occ=</span><span class="dv">2</span><span class="op">-</span><span class="st"> </span>occ <span class="op">%%</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb238-14"><a href="examples.html#cb238-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eye=</span><span class="kw">ifelse</span>(<span class="kw">round</span>(time) <span class="op">==</span><span class="st"> </span>time, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb238-15"><a href="examples.html#cb238-15" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">inv=</span><span class="kw">ifelse</span>(id <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>as_tibble -&gt;</span>
<span id="cb238-16"><a href="examples.html#cb238-16" aria-hidden="true"></a><span class="st">  </span>ev</span></code></pre></div>
</div>
<div id="rxode2-model" class="section level3 hasAnchor" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> rxode2 model<a href="examples.html#rxode2-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This creates the <code>rxode2</code> model with multi-level nesting. Note the
variables <code>inv.Cl</code>, <code>inv.Ka</code>, <code>eta.Cl</code> etc; You only need one variable
for each level of nesting.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="examples.html#cb239-1" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb239-2"><a href="examples.html#cb239-2" aria-hidden="true"></a>  <span class="co">## Clearance with individuals</span></span>
<span id="cb239-3"><a href="examples.html#cb239-3" aria-hidden="true"></a>  <span class="kw">eff</span>(<span class="dv">0</span>) =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb239-4"><a href="examples.html#cb239-4" aria-hidden="true"></a>  C2 =<span class="st"> </span>centr<span class="op">/</span>V2<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>prop.sd);</span>
<span id="cb239-5"><a href="examples.html#cb239-5" aria-hidden="true"></a>  C3 =<span class="st"> </span>peri<span class="op">/</span>V3;</span>
<span id="cb239-6"><a href="examples.html#cb239-6" aria-hidden="true"></a>  CL =<span class="st">  </span>TCl<span class="op">*</span><span class="kw">exp</span>(eta.Cl <span class="op">+</span><span class="st"> </span>eye.Cl <span class="op">+</span><span class="st"> </span>iov.Cl <span class="op">+</span><span class="st"> </span>inv.Cl)</span>
<span id="cb239-7"><a href="examples.html#cb239-7" aria-hidden="true"></a>  KA =<span class="st"> </span>TKA <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(eta.Ka <span class="op">+</span><span class="st"> </span>eye.Ka <span class="op">+</span><span class="st"> </span>iov.Cl <span class="op">+</span><span class="st"> </span>inv.Ka)</span>
<span id="cb239-8"><a href="examples.html#cb239-8" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(depot) =<span class="op">-</span>KA<span class="op">*</span>depot;</span>
<span id="cb239-9"><a href="examples.html#cb239-9" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(centr) =<span class="st"> </span>KA<span class="op">*</span>depot <span class="op">-</span><span class="st"> </span>CL<span class="op">*</span>C2 <span class="op">-</span><span class="st"> </span>Q<span class="op">*</span>C2 <span class="op">+</span><span class="st"> </span>Q<span class="op">*</span>C3;</span>
<span id="cb239-10"><a href="examples.html#cb239-10" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(peri)  =<span class="st">                    </span>Q<span class="op">*</span>C2 <span class="op">-</span><span class="st"> </span>Q<span class="op">*</span>C3;</span>
<span id="cb239-11"><a href="examples.html#cb239-11" aria-hidden="true"></a>  d<span class="op">/</span><span class="kw">dt</span>(eff)  =<span class="st"> </span>Kin <span class="op">-</span><span class="st"> </span>Kout<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>C2<span class="op">/</span>(EC50<span class="op">+</span>C2))<span class="op">*</span>eff;</span>
<span id="cb239-12"><a href="examples.html#cb239-12" aria-hidden="true"></a>  ef0 =<span class="st"> </span>eff <span class="op">+</span><span class="st"> </span>add.sd</span>
<span id="cb239-13"><a href="examples.html#cb239-13" aria-hidden="true"></a>})</span></code></pre></div>
</div>
<div id="uncertainty-in-model-parameters" class="section level3 hasAnchor" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Uncertainty in Model parameters<a href="examples.html#uncertainty-in-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="examples.html#cb240-1" aria-hidden="true"></a>theta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TKA&quot;</span>=<span class="fl">0.294</span>, <span class="st">&quot;TCl&quot;</span>=<span class="fl">18.6</span>, <span class="st">&quot;V2&quot;</span>=<span class="fl">40.2</span>,</span>
<span id="cb240-2"><a href="examples.html#cb240-2" aria-hidden="true"></a>           <span class="st">&quot;Q&quot;</span>=<span class="fl">10.5</span>, <span class="st">&quot;V3&quot;</span>=<span class="dv">297</span>, <span class="st">&quot;Kin&quot;</span>=<span class="dv">1</span>, <span class="st">&quot;Kout&quot;</span>=<span class="dv">1</span>, <span class="st">&quot;EC50&quot;</span>=<span class="dv">200</span>)</span>
<span id="cb240-3"><a href="examples.html#cb240-3" aria-hidden="true"></a></span>
<span id="cb240-4"><a href="examples.html#cb240-4" aria-hidden="true"></a><span class="co">## Creating covariance matrix</span></span>
<span id="cb240-5"><a href="examples.html#cb240-5" aria-hidden="true"></a>tmp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">8</span><span class="op">^</span><span class="dv">2</span>), <span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb240-6"><a href="examples.html#cb240-6" aria-hidden="true"></a>tMat &lt;-<span class="st"> </span><span class="kw">tcrossprod</span>(tmp, tmp) <span class="op">/</span><span class="st"> </span>(<span class="dv">8</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb240-7"><a href="examples.html#cb240-7" aria-hidden="true"></a><span class="kw">dimnames</span>(tMat) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">names</span>(theta), <span class="kw">names</span>(theta))</span>
<span id="cb240-8"><a href="examples.html#cb240-8" aria-hidden="true"></a></span>
<span id="cb240-9"><a href="examples.html#cb240-9" aria-hidden="true"></a>tMat</span></code></pre></div>
<pre><code>#&gt;                TKA         TCl            V2             Q           V3
#&gt; TKA   1.408151e-01  0.08277499  0.0180178917 -0.0470325576  0.029172564
#&gt; TCl   8.277499e-02  0.18104452 -0.0532724661 -0.0421074920  0.068093695
#&gt; V2    1.801789e-02 -0.05327247  0.0581816756  0.0001167516  0.006496495
#&gt; Q    -4.703256e-02 -0.04210749  0.0001167516  0.1549374667  0.020764042
#&gt; V3    2.917256e-02  0.06809370  0.0064964951  0.0207640421  0.118986685
#&gt; Kin  -3.445136e-02  0.01464937 -0.0426405263  0.1503174753 -0.039702872
#&gt; Kout -2.904363e-02 -0.04914350  0.0324790929  0.0069332072  0.030349396
#&gt; EC50 -4.017336e-05  0.02850637 -0.0326094799 -0.0489119232 -0.029606732
#&gt;               Kin         Kout          EC50
#&gt; TKA  -0.034451357 -0.029043632 -4.017336e-05
#&gt; TCl   0.014649373 -0.049143503  2.850637e-02
#&gt; V2   -0.042640526  0.032479093 -3.260948e-02
#&gt; Q     0.150317475  0.006933207 -4.891192e-02
#&gt; V3   -0.039702872  0.030349396 -2.960673e-02
#&gt; Kin   0.299597107 -0.074421154 -6.528526e-03
#&gt; Kout -0.074421154  0.061039604 -2.800741e-02
#&gt; EC50 -0.006528526 -0.028007407  4.167429e-02</code></pre>
</div>
<div id="nesting-variability" class="section level3 hasAnchor" number="12.5.4">
<h3><span class="header-section-number">12.5.4</span> Nesting Variability<a href="examples.html#nesting-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify multiple levels of nesting, you can specify it as a nested
<code>lotri</code> matrix; When using this approach you use the condition
operator <code>|</code> to specify what variable nesting occurs on; For the
Bayesian simulation we need to specify how much information we have
for each parameter; For <code>rxode2</code> this is the <code>nu</code> parameter.</p>
<p>In this case:
- id, <code>nu=100</code> or the model came from 100 subjects
- eye, <code>nu=200</code> or the model came from 200 eyes
- occ, <code>nu=200</code> or the model came from 200 occasions
- inv, <code>nu=10</code> or the model came from 10 investigators</p>
<p>To specify this in <code>lotri</code> you can use <code>| var(nu=X)</code>, or:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="examples.html#cb242-1" aria-hidden="true"></a>omega &lt;-<span class="st"> </span><span class="kw">lotri</span>(<span class="kw">lotri</span>(eta.Cl <span class="op">~</span><span class="st"> </span><span class="fl">0.1</span>,</span>
<span id="cb242-2"><a href="examples.html#cb242-2" aria-hidden="true"></a>                     eta.Ka <span class="op">~</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">|</span><span class="st"> </span><span class="kw">id</span>(<span class="dt">nu=</span><span class="dv">100</span>),</span>
<span id="cb242-3"><a href="examples.html#cb242-3" aria-hidden="true"></a>               <span class="kw">lotri</span>(eye.Cl <span class="op">~</span><span class="st"> </span><span class="fl">0.05</span>,</span>
<span id="cb242-4"><a href="examples.html#cb242-4" aria-hidden="true"></a>                     eye.Ka <span class="op">~</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">|</span><span class="st"> </span><span class="kw">eye</span>(<span class="dt">nu=</span><span class="dv">200</span>),</span>
<span id="cb242-5"><a href="examples.html#cb242-5" aria-hidden="true"></a>               <span class="kw">lotri</span>(iov.Cl <span class="op">~</span><span class="st"> </span><span class="fl">0.01</span>,</span>
<span id="cb242-6"><a href="examples.html#cb242-6" aria-hidden="true"></a>                     iov.Ka <span class="op">~</span><span class="st"> </span><span class="fl">0.01</span>) <span class="op">|</span><span class="st"> </span><span class="kw">occ</span>(<span class="dt">nu=</span><span class="dv">200</span>),</span>
<span id="cb242-7"><a href="examples.html#cb242-7" aria-hidden="true"></a>               <span class="kw">lotri</span>(inv.Cl <span class="op">~</span><span class="st"> </span><span class="fl">0.02</span>,</span>
<span id="cb242-8"><a href="examples.html#cb242-8" aria-hidden="true"></a>                     inv.Ka <span class="op">~</span><span class="st"> </span><span class="fl">0.02</span>) <span class="op">|</span><span class="st"> </span><span class="kw">inv</span>(<span class="dt">nu=</span><span class="dv">10</span>))</span>
<span id="cb242-9"><a href="examples.html#cb242-9" aria-hidden="true"></a>omega</span></code></pre></div>
<pre><code>#&gt; $id
#&gt;        eta.Cl eta.Ka
#&gt; eta.Cl    0.1    0.0
#&gt; eta.Ka    0.0    0.1
#&gt; 
#&gt; $eye
#&gt;        eye.Cl eye.Ka
#&gt; eye.Cl   0.05   0.00
#&gt; eye.Ka   0.00   0.05
#&gt; 
#&gt; $occ
#&gt;        iov.Cl iov.Ka
#&gt; iov.Cl   0.01   0.00
#&gt; iov.Ka   0.00   0.01
#&gt; 
#&gt; $inv
#&gt;        inv.Cl inv.Ka
#&gt; inv.Cl   0.02   0.00
#&gt; inv.Ka   0.00   0.02
#&gt; 
#&gt; Properties: nu</code></pre>
</div>
<div id="unexplained-variability" class="section level3 hasAnchor" number="12.5.5">
<h3><span class="header-section-number">12.5.5</span> Unexplained variability<a href="examples.html#unexplained-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The last piece of variability to specify is the unexplained variability</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="examples.html#cb244-1" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="kw">lotri</span>(prop.sd <span class="op">~</span><span class="st"> </span><span class="fl">.25</span>,</span>
<span id="cb244-2"><a href="examples.html#cb244-2" aria-hidden="true"></a>               add.sd<span class="op">~</span><span class="st"> </span><span class="fl">0.125</span>)</span></code></pre></div>
</div>
<div id="solving-the-problem" class="section level3 hasAnchor" number="12.5.6">
<h3><span class="header-section-number">12.5.6</span> Solving the problem<a href="examples.html#solving-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="examples.html#cb245-1" aria-hidden="true"></a>s &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(mod, theta, ev,</span>
<span id="cb245-2"><a href="examples.html#cb245-2" aria-hidden="true"></a>             <span class="dt">thetaMat=</span>tMat, <span class="dt">omega=</span>omega,</span>
<span id="cb245-3"><a href="examples.html#cb245-3" aria-hidden="true"></a>             <span class="dt">sigma=</span>sigma, <span class="dt">sigmaDf=</span><span class="dv">400</span>,</span>
<span id="cb245-4"><a href="examples.html#cb245-4" aria-hidden="true"></a>             <span class="dt">nStud=</span><span class="dv">400</span>)</span></code></pre></div>
<pre><code>#&gt; unhandled error message: EE:[lsoda] 70000 steps taken before reaching tout
#&gt;  @(lsoda.c:750</code></pre>
<pre><code>#&gt; Warning: some ID(s) could not solve the ODEs correctly; These values are
#&gt; replaced with &#39;NA&#39;</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="examples.html#cb248-1" aria-hidden="true"></a><span class="kw">print</span>(s)</span></code></pre></div>
<pre><code>#&gt; -- Solved rxode2 object --
#&gt; -- Parameters ($params): --
#&gt; # A tibble: 8,000 x 24
#&gt;    sim.id id    inv.Cl~1 inv.C~2 inv.K~3 inv.K~4 eye.C~5 eye.C~6 eye.K~7 eye.K~8
#&gt;     &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1      1 1       -0.202   0.314  -0.260   0.170  0.171  -0.420  -0.140  -0.472 
#&gt;  2      1 2       -0.202   0.314  -0.260   0.170  0.0361  0.0354  0.0821 -0.418 
#&gt;  3      1 3       -0.202   0.314  -0.260   0.170  0.269   0.0473 -0.484  -0.101 
#&gt;  4      1 4       -0.202   0.314  -0.260   0.170 -0.231  -0.180  -0.131   0.0724
#&gt;  5      1 5       -0.202   0.314  -0.260   0.170 -0.368   0.129   0.501   0.172 
#&gt;  6      1 6       -0.202   0.314  -0.260   0.170 -0.113  -0.208  -0.590  -0.334 
#&gt;  7      1 7       -0.202   0.314  -0.260   0.170 -0.276   0.117  -0.254  -0.148 
#&gt;  8      1 8       -0.202   0.314  -0.260   0.170  0.231  -0.0689  0.129   0.507 
#&gt;  9      1 9       -0.202   0.314  -0.260   0.170 -0.292  -0.344   0.107   0.232 
#&gt; 10      1 10      -0.202   0.314  -0.260   0.170 -0.293   0.0939 -0.514  -0.185 
#&gt; # ... with 7,990 more rows, 14 more variables: `iov.Cl(occ==1)` &lt;dbl&gt;,
#&gt; #   `iov.Cl(occ==2)` &lt;dbl&gt;, `iov.Ka(occ==1)` &lt;dbl&gt;, `iov.Ka(occ==2)` &lt;dbl&gt;,
#&gt; #   V2 &lt;dbl&gt;, V3 &lt;dbl&gt;, TCl &lt;dbl&gt;, eta.Cl &lt;dbl&gt;, TKA &lt;dbl&gt;, eta.Ka &lt;dbl&gt;,
#&gt; #   Q &lt;dbl&gt;, Kin &lt;dbl&gt;, Kout &lt;dbl&gt;, EC50 &lt;dbl&gt;, and abbreviated variable names
#&gt; #   1: `inv.Cl(inv==1)`, 2: `inv.Cl(inv==2)`, 3: `inv.Ka(inv==1)`,
#&gt; #   4: `inv.Ka(inv==2)`, 5: `eye.Cl(eye==1)`, 6: `eye.Cl(eye==2)`,
#&gt; #   7: `eye.Ka(eye==1)`, 8: `eye.Ka(eye==2)`
#&gt; -- Initial Conditions ($inits): --
#&gt; depot centr  peri   eff 
#&gt;     0     0     0     1 
#&gt; 
#&gt; Simulation with uncertainty in:
#&gt; * parameters ($thetaMat for changes)
#&gt; * omega matrix ($omegaList)
#&gt; 
#&gt; -- First part of data (object): --
#&gt; # A tibble: 976,000 x 21
#&gt;   sim.id    id time inv.Cl inv.Ka eye.Cl eye.Ka  iov.Cl iov.Ka     C2       C3
#&gt;    &lt;int&gt; &lt;int&gt;  [h]  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1      1     1  0   -0.202 -0.260  0.171 -0.140 -0.0381 0.0391   0     0      
#&gt; 2      1     1  0.1 -0.202 -0.260 -0.420 -0.472 -0.0381 0.0391  -2.95 -0.00314
#&gt; 3      1     1  4   -0.202 -0.260  0.171 -0.140 -0.0381 0.0391 -53.9  -2.18   
#&gt; 4      1     1  4.1 -0.202 -0.260 -0.420 -0.472 -0.0381 0.0391 -36.2  -2.27   
#&gt; 5      1     1  8   -0.202 -0.260  0.171 -0.140 -0.0381 0.0391 -58.0  -6.11   
#&gt; 6      1     1  8.1 -0.202 -0.260 -0.420 -0.472 -0.0381 0.0391 -22.8  -6.22   
#&gt; # ... with 975,994 more rows, and 10 more variables: CL &lt;dbl&gt;, KA &lt;dbl&gt;,
#&gt; #   ef0 &lt;dbl&gt;, depot &lt;dbl&gt;, centr &lt;dbl&gt;, peri &lt;dbl&gt;, eff &lt;dbl&gt;, occ &lt;fct&gt;,
#&gt; #   eye &lt;fct&gt;, inv &lt;fct&gt;</code></pre>
<p>There are multiple investigators in a study; Each investigator has a
number of individuals enrolled at their site. <code>rxode2</code> automatically
determines the number of investigators and then will simulate an
effect for each investigator. With the output, <code>inv.Cl(inv==1)</code> will
be the <code>inv.Cl</code> for investigator 1, <code>inv.Cl(inv==2)</code> will be the
<code>inv.Cl</code> for investigator 2, etc.</p>
<p><code>inv.Cl(inv==1)</code>, <code>inv.Cl(inv==2)</code>, etc will be simulated for each
study and then combined to form the between investigator
variability. In equation form these represent the following:</p>
<pre><code>inv.Cl = (inv == 1) * `inv.Cl(inv==1)` + (inv == 2) * `inv.Cl(inv==2)`</code></pre>
<p>If you look at the simulated parameters you can see <code>inv.Cl(inv==1)</code>
and <code>inv.Cl(inv==2)</code> are in the <code>s$params</code>; They are the same for each
study:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="examples.html#cb251-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">head</span>(s<span class="op">$</span>params))</span></code></pre></div>
<pre><code>#&gt;   sim.id id inv.Cl(inv==1) inv.Cl(inv==2) inv.Ka(inv==1) inv.Ka(inv==2)
#&gt; 1      1  1     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt; 2      1  2     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt; 3      1  3     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt; 4      1  4     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt; 5      1  5     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt; 6      1  6     -0.2022386      0.3144136     -0.2599115      0.1699445
#&gt;   eye.Cl(eye==1) eye.Cl(eye==2) eye.Ka(eye==1) eye.Ka(eye==2) iov.Cl(occ==1)
#&gt; 1     0.17073129    -0.41996232     -0.1396676    -0.47194363   -0.038088093
#&gt; 2     0.03607197     0.03541692      0.0821007    -0.41780285   -0.137537040
#&gt; 3     0.26936860     0.04732331     -0.4842336    -0.10113442    0.051341682
#&gt; 4    -0.23101553    -0.17967167     -0.1311976     0.07238211    0.083307828
#&gt; 5    -0.36771204     0.12904386      0.5007750     0.17169021   -0.006988387
#&gt; 6    -0.11255970    -0.20831770     -0.5903606    -0.33404416    0.017359073
#&gt;   iov.Cl(occ==2) iov.Ka(occ==1) iov.Ka(occ==2)       V2       V3      TCl
#&gt; 1    -0.02640295     0.03906335     0.08082907 40.30657 297.0657 17.98116
#&gt; 2     0.11320643    -0.05818325    -0.04738385 40.30657 297.0657 17.98116
#&gt; 3    -0.09714493     0.11129638    -0.08423628 40.30657 297.0657 17.98116
#&gt; 4    -0.16483538     0.02682606     0.05338649 40.30657 297.0657 17.98116
#&gt; 5    -0.14905541    -0.12916147     0.15052921 40.30657 297.0657 17.98116
#&gt; 6    -0.06090189    -0.03821761     0.22133375 40.30657 297.0657 17.98116
#&gt;       eta.Cl       TKA     eta.Ka        Q       Kin     Kout     EC50
#&gt; 1  0.1255527 -0.201923 -0.5537485 10.27033 0.3588164 1.273849 200.1076
#&gt; 2 -0.4939314 -0.201923  0.1843165 10.27033 0.3588164 1.273849 200.1076
#&gt; 3  0.3628319 -0.201923 -0.1429071 10.27033 0.3588164 1.273849 200.1076
#&gt; 4  0.9051354 -0.201923  0.3662940 10.27033 0.3588164 1.273849 200.1076
#&gt; 5  0.6288535 -0.201923 -0.0873943 10.27033 0.3588164 1.273849 200.1076
#&gt; 6  0.2794271 -0.201923  0.3369920 10.27033 0.3588164 1.273849 200.1076</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="examples.html#cb253-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">head</span>(s<span class="op">$</span>params <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(sim.id <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>#&gt;   sim.id id inv.Cl(inv==1) inv.Cl(inv==2) inv.Ka(inv==1) inv.Ka(inv==2)
#&gt; 1      2  1       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt; 2      2  2       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt; 3      2  3       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt; 4      2  4       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt; 5      2  5       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt; 6      2  6       0.269099    -0.03113882     -0.2495935    -0.07401625
#&gt;   eye.Cl(eye==1) eye.Cl(eye==2) eye.Ka(eye==1) eye.Ka(eye==2) iov.Cl(occ==1)
#&gt; 1      0.1241993    0.041788101    0.046696060     -0.4757259    -0.12703256
#&gt; 2     -0.2429869   -0.272713695    0.535736941     -0.2558208    -0.07818270
#&gt; 3     -0.2394184   -0.191109523   -0.008623256      0.2089974    -0.10398049
#&gt; 4     -0.1136205    0.009124802   -0.061481545      0.1693383     0.28689686
#&gt; 5     -0.0571466    0.079101905    0.020527524     -0.3797383    -0.08602325
#&gt; 6      0.3404940    0.181620316   -0.230666768     -0.2565292    -0.06364471
#&gt;   iov.Cl(occ==2) iov.Ka(occ==1) iov.Ka(occ==2)       V2       V3      TCl
#&gt; 1     0.03439817    0.013110729     0.05902598 40.11784 296.8096 18.42138
#&gt; 2     0.12976537    0.097348229     0.01634439 40.11784 296.8096 18.42138
#&gt; 3    -0.02100928    0.064078040    -0.12742109 40.11784 296.8096 18.42138
#&gt; 4     0.02594699   -0.095784927     0.25669770 40.11784 296.8096 18.42138
#&gt; 5     0.04611064    0.123204785     0.02336934 40.11784 296.8096 18.42138
#&gt; 6    -0.03241107   -0.005876249     0.13239904 40.11784 296.8096 18.42138
#&gt;        eta.Cl       TKA      eta.Ka        Q      Kin      Kout     EC50
#&gt; 1  0.41059476 0.1568122  0.21051066 10.97538 1.775872 0.8755069 200.0143
#&gt; 2  0.12890626 0.1568122 -0.20523053 10.97538 1.775872 0.8755069 200.0143
#&gt; 3 -0.03656252 0.1568122  0.01471664 10.97538 1.775872 0.8755069 200.0143
#&gt; 4 -0.18554527 0.1568122 -0.62093051 10.97538 1.775872 0.8755069 200.0143
#&gt; 5 -0.04484490 0.1568122 -0.06739060 10.97538 1.775872 0.8755069 200.0143
#&gt; 6  0.48614515 0.1568122 -0.35082813 10.97538 1.775872 0.8755069 200.0143</code></pre>
<p>For between eye variability and between occasion variability each
individual simulates a number of variables that become the between eye
and between occasion variability; In the case of the eye:</p>
<pre><code>eye.Cl = (eye == 1) * `eye.Cl(eye==1)` + (eye == 2) * `eye.Cl(eye==2)`</code></pre>
<p>So when you look the simulation each of these variables (ie
<code>eye.Cl(eye==1)</code>, <code>eye.Cl(eye==2)</code>, etc) they change for each
individual and when combined make the between eye variability or the
between occasion variability that can be seen in some pharamcometric
models.</p>
</div>
</div>
<div id="transit-compartment-models" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Transit compartment models<a href="examples.html#transit-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Savic 2008 first introduced the idea of transit compartments being a
mechanistic explanation of a a lag-time type phenomena. rxode2 has special handling of these models:</p>
<p>You can specify this in a similar manner as the original paper:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="examples.html#cb256-1" aria-hidden="true"></a><span class="kw">library</span>(rxode2)</span>
<span id="cb256-2"><a href="examples.html#cb256-2" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb256-3"><a href="examples.html#cb256-3" aria-hidden="true"></a>    <span class="co">## Table 3 from Savic 2007</span></span>
<span id="cb256-4"><a href="examples.html#cb256-4" aria-hidden="true"></a>    cl =<span class="st"> </span><span class="fl">17.2</span> <span class="co"># (L/hr)</span></span>
<span id="cb256-5"><a href="examples.html#cb256-5" aria-hidden="true"></a>    vc =<span class="st"> </span><span class="fl">45.1</span> <span class="co"># L</span></span>
<span id="cb256-6"><a href="examples.html#cb256-6" aria-hidden="true"></a>    ka =<span class="st"> </span><span class="fl">0.38</span> <span class="co"># 1/hr</span></span>
<span id="cb256-7"><a href="examples.html#cb256-7" aria-hidden="true"></a>    mtt =<span class="st"> </span><span class="fl">0.37</span> <span class="co"># hr</span></span>
<span id="cb256-8"><a href="examples.html#cb256-8" aria-hidden="true"></a>    bio=<span class="dv">1</span></span>
<span id="cb256-9"><a href="examples.html#cb256-9" aria-hidden="true"></a>    n =<span class="st"> </span><span class="fl">20.1</span></span>
<span id="cb256-10"><a href="examples.html#cb256-10" aria-hidden="true"></a>    k =<span class="st"> </span>cl<span class="op">/</span>vc</span>
<span id="cb256-11"><a href="examples.html#cb256-11" aria-hidden="true"></a>    ktr =<span class="st"> </span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>mtt</span>
<span id="cb256-12"><a href="examples.html#cb256-12" aria-hidden="true"></a>    <span class="co">## note that lgammafn is the same as lgamma in R.</span></span>
<span id="cb256-13"><a href="examples.html#cb256-13" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(depot) =<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(bio<span class="op">*</span><span class="kw">podo</span>(depot))<span class="op">+</span><span class="kw">log</span>(ktr)<span class="op">+</span>n<span class="op">*</span><span class="kw">log</span>(ktr<span class="op">*</span><span class="kw">tad</span>(depot))<span class="op">-</span></span>
<span id="cb256-14"><a href="examples.html#cb256-14" aria-hidden="true"></a><span class="st">                        </span>ktr<span class="op">*</span><span class="kw">tad</span>(depot)<span class="op">-</span><span class="kw">lgammafn</span>(n<span class="op">+</span><span class="dv">1</span>))<span class="op">-</span>ka<span class="op">*</span>depot</span>
<span id="cb256-15"><a href="examples.html#cb256-15" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(cen) =<span class="st"> </span>ka<span class="op">*</span>depot<span class="op">-</span>k<span class="op">*</span>cen</span>
<span id="cb256-16"><a href="examples.html#cb256-16" aria-hidden="true"></a>})</span>
<span id="cb256-17"><a href="examples.html#cb256-17" aria-hidden="true"></a></span>
<span id="cb256-18"><a href="examples.html#cb256-18" aria-hidden="true"></a>et &lt;-<span class="st"> </span><span class="kw">eventTable</span>()</span>
<span id="cb256-19"><a href="examples.html#cb256-19" aria-hidden="true"></a>et<span class="op">$</span><span class="kw">add.sampling</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dt">length.out=</span><span class="dv">200</span>))</span>
<span id="cb256-20"><a href="examples.html#cb256-20" aria-hidden="true"></a>et<span class="op">$</span><span class="kw">add.dosing</span>(<span class="dv">20</span>, <span class="dt">start.time=</span><span class="dv">0</span>, <span class="dt">evid=</span><span class="dv">7</span>)</span>
<span id="cb256-21"><a href="examples.html#cb256-21" aria-hidden="true"></a></span>
<span id="cb256-22"><a href="examples.html#cb256-22" aria-hidden="true"></a>transit &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(mod, et)</span>
<span id="cb256-23"><a href="examples.html#cb256-23" aria-hidden="true"></a></span>
<span id="cb256-24"><a href="examples.html#cb256-24" aria-hidden="true"></a><span class="kw">plot</span>(transit, cen, <span class="dt">ylab=</span><span class="st">&quot;Central Concentration&quot;</span>)</span></code></pre></div>
<p><img src="rxode2-manual_files/figure-html/unnamed-chunk-163-1.png" width="100%" /></p>
<p>Another option is to specify the transit compartment function
<code>transit</code> syntax. This specifies the parameters <code>transit(number of transit compartments, mean transit time, bioavailability)</code>. The
bioavailability term is optional.</p>
<p>The same model can be specified by:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="examples.html#cb257-1" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">rxode2</span>({</span>
<span id="cb257-2"><a href="examples.html#cb257-2" aria-hidden="true"></a>    <span class="co">## Table 3 from Savic 2007</span></span>
<span id="cb257-3"><a href="examples.html#cb257-3" aria-hidden="true"></a>    cl =<span class="st"> </span><span class="fl">17.2</span> <span class="co"># (L/hr)</span></span>
<span id="cb257-4"><a href="examples.html#cb257-4" aria-hidden="true"></a>    vc =<span class="st"> </span><span class="fl">45.1</span> <span class="co"># L</span></span>
<span id="cb257-5"><a href="examples.html#cb257-5" aria-hidden="true"></a>    ka =<span class="st"> </span><span class="fl">0.38</span> <span class="co"># 1/hr</span></span>
<span id="cb257-6"><a href="examples.html#cb257-6" aria-hidden="true"></a>    mtt =<span class="st"> </span><span class="fl">0.37</span> <span class="co"># hr</span></span>
<span id="cb257-7"><a href="examples.html#cb257-7" aria-hidden="true"></a>    bio=<span class="dv">1</span></span>
<span id="cb257-8"><a href="examples.html#cb257-8" aria-hidden="true"></a>    n =<span class="st"> </span><span class="fl">20.1</span></span>
<span id="cb257-9"><a href="examples.html#cb257-9" aria-hidden="true"></a>    k =<span class="st"> </span>cl<span class="op">/</span>vc</span>
<span id="cb257-10"><a href="examples.html#cb257-10" aria-hidden="true"></a>    ktr =<span class="st"> </span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>mtt</span>
<span id="cb257-11"><a href="examples.html#cb257-11" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(depot) =<span class="st"> </span><span class="kw">transit</span>(n,mtt,bio)<span class="op">-</span>ka<span class="op">*</span>depot</span>
<span id="cb257-12"><a href="examples.html#cb257-12" aria-hidden="true"></a>    d<span class="op">/</span><span class="kw">dt</span>(cen) =<span class="st"> </span>ka<span class="op">*</span>depot<span class="op">-</span>k<span class="op">*</span>cen</span>
<span id="cb257-13"><a href="examples.html#cb257-13" aria-hidden="true"></a>})</span>
<span id="cb257-14"><a href="examples.html#cb257-14" aria-hidden="true"></a></span>
<span id="cb257-15"><a href="examples.html#cb257-15" aria-hidden="true"></a>et &lt;-<span class="st"> </span><span class="kw">eventTable</span>();</span>
<span id="cb257-16"><a href="examples.html#cb257-16" aria-hidden="true"></a>et<span class="op">$</span><span class="kw">add.sampling</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dt">length.out=</span><span class="dv">200</span>));</span>
<span id="cb257-17"><a href="examples.html#cb257-17" aria-hidden="true"></a>et<span class="op">$</span><span class="kw">add.dosing</span>(<span class="dv">20</span>, <span class="dt">start.time=</span><span class="dv">0</span>, <span class="dt">evid=</span><span class="dv">7</span>);</span>
<span id="cb257-18"><a href="examples.html#cb257-18" aria-hidden="true"></a></span>
<span id="cb257-19"><a href="examples.html#cb257-19" aria-hidden="true"></a>transit &lt;-<span class="st"> </span><span class="kw">rxSolve</span>(mod, et)</span>
<span id="cb257-20"><a href="examples.html#cb257-20" aria-hidden="true"></a></span>
<span id="cb257-21"><a href="examples.html#cb257-21" aria-hidden="true"></a><span class="kw">plot</span>(transit, cen, <span class="dt">ylab=</span><span class="st">&quot;Central Concentration&quot;</span>)</span></code></pre></div>
<p><img src="rxode2-manual_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>A couple of things to keep in mind when using this approach:</p>
<ul>
<li><p>This approach implicitly assumes that the absorption through the
transit compartment is completed before the next dose begins</p></li>
<li><p>Different types of doses (ie bolus/infusion) to the compartment
affect the time after dose calculation (<code>tad</code>) which is used in the
transit compartment calculation. These (therefore) are not
currently supported. The most stable way is to use <code>tad(cmt)</code> and
<code>podo(cmt)</code>, this way doses to other compartments do not affect the
transit compartment calculation.</p></li>
<li><p>Internally, the <code>transit</code> syntax uses either the currently defined
cmt <code>d/dt(cmt)=transit(...)</code>, or <code>cmt</code>. If the transit compartment
is used outside of a <code>d/dt()</code> (not recommended), the <code>cmt</code> that is
used is the last <code>d/dt(cmt)</code> defined it the model. This also means
compartments do not affect one another (ie a oral, transit
compartment drug dosed immediately with an IV infusion)</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-miscellaneous-topics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rxode2-manual.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
